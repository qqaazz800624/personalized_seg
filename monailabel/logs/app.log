[2025-05-15 08:35:55,585] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:37:02,561] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:37:02,932] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:37:03,409] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:37:03,409] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:37:03,410] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:37:03,411] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:37:03,461] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:37:03,461] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-15 08:39:32,596] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:39:32,933] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:39:33,400] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:39:33,401] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:39:33,401] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:39:33,402] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:39:33,492] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:39:33,492] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-15 08:39:33,725] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f8e2e030a00>
[2025-05-15 08:39:33,736] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-15 08:39:33,737] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:39:33,738] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f8e27f4f370>
[2025-05-15 08:39:33,738] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:39:33,741] [1] [MainThread] [INFO] (monailabel.utils.others.generic:187) - Downloading resource: /apps/radiology/model/sam2.1_hiera_large.pt from https://huggingface.co/facebook/sam2.1-hiera-large/resolve/main/sam2.1_hiera_large.pt
[2025-05-15 08:39:56,295] [1] [MainThread] [INFO] (monailabel.utils.others.generic:187) - Downloading resource: /apps/radiology/model/sam2.1_hiera_l.yaml from https://huggingface.co/facebook/sam2.1-hiera-large/resolve/main/sam2.1_hiera_l.yaml
[2025-05-15 08:39:57,615] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f8e2e030a00>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f8e2e030460>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f8e2e0304c0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f8e2d1d76d0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f8e2d151360>}
[2025-05-15 08:39:57,744] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f8e3fe5efe0>
[2025-05-15 08:39:57,744] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-15 08:39:57,745] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-15 08:39:57,745] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-15 08:39:57,748] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:39:57,748] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f8e27f57250>
[2025-05-15 08:39:57,749] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:41:09,816] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'nanaha1003'}
[2025-05-15 08:41:09,817] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: s0005_mri; Weight: 7176620
[2025-05-15 08:41:09,897] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': 's0005_mri', 'weight': 7176620, 'path': '/data/s0005_mri.nii.gz', 'ts': 1740121317, 'name': 's0005_mri.nii.gz'}
[2025-05-15 08:41:17,558] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pan_mri_mednext', 'image': 's0005_mri', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'nanaha1003'}
[2025-05-15 08:41:17,559] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pan_mri_mednext', 'image': '/data/s0005_mri.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'nanaha1003', 'description': 'MedNeXt multiorgan segmentaion model open MRI dataset.\n'}
[2025-05-15 08:41:17,580] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-15 08:41:17,580] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-15 08:41:17,617] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.0358; image: torch.Size([256, 17, 256])(torch.float32)
[2025-05-15 08:41:17,619] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0019; image: torch.Size([1, 256, 17, 256])(torch.float32)
[2025-05-15 08:41:17,628] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0085; image: torch.Size([1, 256, 17, 256])(torch.float32)
[2025-05-15 08:41:18,456] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.8283; image: torch.Size([1, 320, 108, 320])(torch.float32)
[2025-05-15 08:41:18,481] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityd): Time: 0.0247; image: torch.Size([1, 320, 108, 320])(torch.float32)
[2025-05-15 08:41:18,482] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 320, 108, 320])(torch.float32)
[2025-05-15 08:41:18,484] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [128, 128, 128], 'sw_batch_size': 1, 'overlap': 0.5, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-15 08:41:18,485] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/best_model_pan.pt
[2025-05-15 08:41:23,822] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-15 08:41:23,823] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-15 08:41:24,084] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.26; image: torch.Size([16, 256, 17, 256])(torch.float32); pred: torch.Size([16, 320, 108, 320])(torch.float32)
[2025-05-15 08:41:24,087] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0025; image: torch.Size([16, 256, 17, 256])(torch.float32); pred: torch.Size([16, 320, 108, 320])(torch.float32)
[2025-05-15 08:41:24,088] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-15 08:41:24,088] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-15 08:41:24,089] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 320, 108, 320])(torch.float32); pred: torch.Size([16, 256, 17, 256])(torch.float32)
[2025-05-15 08:41:24,110] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0209; image: torch.Size([1, 320, 108, 320])(torch.float32); pred: torch.Size([16, 256, 17, 256])(torch.float32)
[2025-05-15 08:41:24,123] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0122; image: torch.Size([1, 320, 108, 320])(torch.float32); pred: torch.Size([1, 256, 17, 256])(torch.float32)
[2025-05-15 08:41:24,123] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 320, 108, 320])(torch.float32); pred: torch.Size([256, 17, 256])(torch.float32)
[2025-05-15 08:41:24,124] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-15 08:41:24,125] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-15 08:41:27,732] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 10.1731; Pre: 0.9231; Inferer: 5.3122; Invert: 0.2922; Post: 0.0368; Write: 3.6078
[2025-05-15 08:41:27,732] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpqz3ihotk.nrrd
[2025-05-15 08:41:27,733] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-15 08:42:15,245] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'nanaha1003'}
[2025-05-15 08:42:15,246] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: s0015_mri; Weight: 7176686
[2025-05-15 08:42:15,250] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': 's0015_mri', 'weight': 7176686, 'path': '/data/s0015_mri.nii.gz', 'ts': 1740123767, 'name': 's0015_mri.nii.gz'}
[2025-05-15 08:42:19,361] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pan_mri_mednext', 'image': 's0015_mri', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'nanaha1003'}
[2025-05-15 08:42:19,362] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pan_mri_mednext', 'image': '/data/s0015_mri.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'nanaha1003', 'description': 'MedNeXt multiorgan segmentaion model open MRI dataset.\n'}
[2025-05-15 08:42:19,364] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-15 08:42:19,365] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-15 08:42:19,587] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.2203; image: torch.Size([256, 256, 140])(torch.float32)
[2025-05-15 08:42:19,587] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0002; image: torch.Size([1, 256, 256, 140])(torch.float32)
[2025-05-15 08:42:19,589] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0017; image: torch.Size([1, 256, 256, 140])(torch.float32)
[2025-05-15 08:42:20,161] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 0.5713; image: torch.Size([1, 240, 240, 140])(torch.float32)
[2025-05-15 08:42:20,194] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityd): Time: 0.0322; image: torch.Size([1, 240, 240, 140])(torch.float32)
[2025-05-15 08:42:20,194] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 240, 240, 140])(torch.float32)
[2025-05-15 08:42:20,195] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [128, 128, 128], 'sw_batch_size': 1, 'overlap': 0.5, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-15 08:42:20,195] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/best_model_pan.pt
[2025-05-15 08:42:24,817] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-15 08:42:24,817] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-15 08:42:24,845] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.0258; image: torch.Size([16, 256, 256, 140])(torch.float32); pred: torch.Size([16, 240, 240, 140])(torch.float32)
[2025-05-15 08:42:24,847] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0023; image: torch.Size([16, 256, 256, 140])(torch.float32); pred: torch.Size([16, 240, 240, 140])(torch.float32)
[2025-05-15 08:42:24,848] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-15 08:42:24,849] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-15 08:42:24,850] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 240, 240, 140])(torch.float32); pred: torch.Size([16, 256, 256, 140])(torch.float32)
[2025-05-15 08:42:24,850] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0003; image: torch.Size([1, 240, 240, 140])(torch.float32); pred: torch.Size([16, 256, 256, 140])(torch.float32)
[2025-05-15 08:42:24,851] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0004; image: torch.Size([1, 240, 240, 140])(torch.float32); pred: torch.Size([1, 256, 256, 140])(torch.float32)
[2025-05-15 08:42:24,851] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 240, 240, 140])(torch.float32); pred: torch.Size([256, 256, 140])(torch.float32)
[2025-05-15 08:42:24,852] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-15 08:42:24,853] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-15 08:42:24,962] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 5.6006; Pre: 0.8321; Inferer: 4.5998; Invert: 0.0531; Post: 0.0042; Write: 0.1103
[2025-05-15 08:42:24,962] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpiovwt5tf.nrrd
[2025-05-15 08:42:24,963] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-15 08:43:05,561] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:101) - Saving Label for s0015_mri for tag: final by admin
[2025-05-15 08:43:05,562] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info": [{"name": "spleen", "idx": 2}, {"name": "right_kidney", "idx": 3}, {"name": "left_kidney", "idx": 4}, {"name": "gall_bladder", "idx": 5}, {"name": "esophagus", "idx": 6}, {"name": "liver", "idx": 7}, {"name": "stomach", "idx": 8}, {"name": "arotas", "idx": 9}, {"name": "postcava", "idx": 10}, {"name": "pancreas", "idx": 11}, {"name": "right_adrenal_gland", "idx": 12}, {"name": "left_adrenal_gland", "idx": 13}, {"name": "duodenum", "idx": 14}, {"name": "bladder", "idx": 15}, {"name": "prostate_uterus", "idx": 16}], "client_id": "nanaha1003"}
[2025-05-15 08:43:05,562] [1] [MainThread] [INFO] (monailabel.datastore.local:486) - Saving Label for Image: s0015_mri; Tag: final; Info: {'label_info': [{'name': 'spleen', 'idx': 2}, {'name': 'right_kidney', 'idx': 3}, {'name': 'left_kidney', 'idx': 4}, {'name': 'gall_bladder', 'idx': 5}, {'name': 'esophagus', 'idx': 6}, {'name': 'liver', 'idx': 7}, {'name': 'stomach', 'idx': 8}, {'name': 'arotas', 'idx': 9}, {'name': 'postcava', 'idx': 10}, {'name': 'pancreas', 'idx': 11}, {'name': 'right_adrenal_gland', 'idx': 12}, {'name': 'left_adrenal_gland', 'idx': 13}, {'name': 'duodenum', 'idx': 14}, {'name': 'bladder', 'idx': 15}, {'name': 'prostate_uterus', 'idx': 16}], 'client_id': 'nanaha1003'}
[2025-05-15 08:43:05,563] [1] [MainThread] [INFO] (monailabel.datastore.local:494) - Adding Label: s0015_mri => final => /tmp/tmpzkavlevm.nii.gz
[2025-05-15 08:43:05,593] [1] [MainThread] [INFO] (monailabel.datastore.local:510) - Label Info: {'label_info': [{'name': 'spleen', 'idx': 2}, {'name': 'right_kidney', 'idx': 3}, {'name': 'left_kidney', 'idx': 4}, {'name': 'gall_bladder', 'idx': 5}, {'name': 'esophagus', 'idx': 6}, {'name': 'liver', 'idx': 7}, {'name': 'stomach', 'idx': 8}, {'name': 'arotas', 'idx': 9}, {'name': 'postcava', 'idx': 10}, {'name': 'pancreas', 'idx': 11}, {'name': 'right_adrenal_gland', 'idx': 12}, {'name': 'left_adrenal_gland', 'idx': 13}, {'name': 'duodenum', 'idx': 14}, {'name': 'bladder', 'idx': 15}, {'name': 'prostate_uterus', 'idx': 16}], 'client_id': 'nanaha1003', 'ts': 1747298585, 'name': 's0015_mri.nii.gz'}
[2025-05-15 08:43:05,597] [1] [MainThread] [INFO] (monailabel.interfaces.app:493) - New label saved for: s0015_mri => s0015_mri
[2025-05-15 08:43:06,373] [1] [Thread-2] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:43:16,969] [1] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'pan_mri_mednext', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'nanaha1003'}
[2025-05-15 08:43:16,971] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /usr::/apps/radiology
[2025-05-15 08:43:16,972] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /usr::/apps/radiology
[2025-05-15 08:43:16,972] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /usr/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"pan_mri_mednext","name":"train_01","pretrained":true,"device":"Tesla P100-PCIE-16GB:0","max_epochs":100,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":2,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":"SmartCacheDataset","dataloader":"ThreadDataLoader","tracking":"mlflow","tracking_uri":"","tracking_experiment_name":"","client_id":"nanaha1003"}
[2025-05-15 08:43:17,430] [95] [MainThread] [INFO] (__main__:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:43:24,456] [95] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:43:24,676] [95] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:43:24,676] [95] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:43:24,676] [95] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:43:24,677] [95] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: False; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:43:24,691] [95] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:43:24,888] [95] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f3ba0b63460>
Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
[2025-05-15 08:43:24,894] [95] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-15 08:43:24,895] [timeloop] [INFO] Starting Timeloop..
[2025-05-15 08:43:24,895] [95] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:43:24,895] [timeloop] [INFO] Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f3b9fcaacb0>
[2025-05-15 08:43:24,895] [95] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f3b9fcaacb0>
[2025-05-15 08:43:24,895] [timeloop] [INFO] Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:43:24,895] [95] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
[2025-05-15 08:43:24,900] [95] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f3ba0b63460>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f3ba0b62ec0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f3ba0b62f20>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f3ba018f250>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f3b9fe97df0>}
[2025-05-15 08:43:25,029] [95] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f3b9fc75000>
[2025-05-15 08:43:25,029] [95] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-15 08:43:25,029] [95] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-15 08:43:25,029] [95] [MainThread] [INFO] (monailabel.tasks.train.basic_train:436) - Train Request (input): {'model': 'pan_mri_mednext', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'nanaha1003', 'local_rank': 0}
[2025-05-15 08:43:25,029] [95] [MainThread] [INFO] (monailabel.tasks.train.basic_train:449) - CUDA_VISIBLE_DEVICES: None
[2025-05-15 08:43:25,030] [95] [MainThread] [INFO] (monailabel.tasks.train.basic_train:459) - Distributed/Multi GPU Training = TRUE
[2025-05-15 08:43:25,030] [95] [MainThread] [INFO] (monailabel.tasks.train.basic_train:465) - Total proces to spawn: 2
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
[2025-05-15 08:43:32.670][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 0
[2025-05-15 08:43:32.671][ INFO](monailabel.tasks.train.basic_train) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pan_mri_mednext', 'client_id': 'nanaha1003', 'local_rank': 0, 'run_id': '20250515_084325'}
[2025-05-15 08:43:33.241][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 1
[2025-05-15 08:43:33.241][ INFO](monailabel.tasks.train.basic_train) - 1 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pan_mri_mednext', 'client_id': 'nanaha1003', 'local_rank': 0, 'run_id': '20250515_084325'}
[2025-05-15 08:43:33.316][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:1 => Using GPU-1
[2025-05-15 08:43:33.316][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:0 => Using GPU-0
[2025-05-15 08:43:33.349][ INFO](monailabel.tasks.train.basic_train) - 0 - Using Device: cuda:0; IDX: 0
[2025-05-15 08:43:33.349][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pan_mri_mednext/train_01
[2025-05-15 08:43:33.349][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-15 08:43:33.349][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pan_mri_mednext/train_01/mlruns;
[2025-05-15 08:43:33.349][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pan_mri_mednext; Run Name: run_20250515_084325
[2025-05-15 08:43:33.350][ INFO](monailabel.tasks.train.basic_train) - Total Records for Training: 3
[2025-05-15 08:43:33.350][ INFO](monailabel.tasks.train.basic_train) - Total Records for Validation: 1
[2025-05-15 08:43:33.704][ INFO](monailabel.tasks.train.basic_train) - 1 - Using Device: cuda:1; IDX: 1
[2025-05-15 08:43:33.704][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pan_mri_mednext/train_01
[2025-05-15 08:43:33.704][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-15 08:43:33.704][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pan_mri_mednext/train_01/mlruns;
[2025-05-15 08:43:33.704][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pan_mri_mednext; Run Name: run_20250515_084325
[rank0]:[W515 08:43:34.382912436 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
W0515 08:43:35.191000 95 local/lib/python3.10/dist-packages/torch/multiprocessing/spawn.py:160] Terminating process 170 via signal SIGTERM
-------------------------------------------------------------------------------
runpy.py 196 _run_module_as_main
return _run_code(code, main_globals, None,
runpy.py 86 _run_code
exec(code, run_globals)
app.py 128 <module>
run_main()
app.py 113 run_main
result = a.train(request)
app.py 423 train
result = task(request, self.datastore())
basic_train.py 466 __call__
torch.multiprocessing.spawn(main_worker, nprocs=world_size, args=(world_size, req, datalist, self))
spawn.py 328 spawn
return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
spawn.py 284 start_processes
while not context.join():
spawn.py 203 join
raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException:
-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 735, in main_worker
    task.train(rank, world_size, request, datalist)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 546, in train
    context.network, context.optimizer = self._create_network_and_optimizer(context)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 640, in _create_network_and_optimizer
    network = torch.nn.parallel.DistributedDataParallel(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 825, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/usr/local/lib/python3.10/dist-packages/torch/distributed/utils.py", line 288, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: NCCL error in: ../torch/csrc/distributed/c10d/NCCLUtils.hpp:317, unhandled system error (run with NCCL_DEBUG=INFO for details), NCCL version 2.21.5
ncclSystemError: System call (e.g. socket, malloc) or external library call failed or device error.
Last error:
Error while creating shared memory segment /dev/shm/nccl-hnvZfh (size 9637888)
[2025-05-15 08:43:36,423] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2025-05-15 08:45:54,116] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:45:54,448] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:45:54,915] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:45:54,915] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:45:54,916] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:45:54,917] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:45:54,928] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:45:54,928] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-15 08:45:55,165] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7faaa4b32980>
[2025-05-15 08:45:55,172] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-15 08:45:55,173] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:45:55,173] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7faaa2be3400>
[2025-05-15 08:45:55,174] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:45:55,179] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7faaa4b32980>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7faaa4b323e0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7faaa4b32440>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7faaa41766e0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7faaa3eb7640>}
[2025-05-15 08:45:55,307] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7faaa2bc1060>
[2025-05-15 08:45:55,307] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-15 08:45:55,308] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-15 08:45:55,308] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-15 08:45:55,310] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:45:55,310] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7faaa2bf1750>
[2025-05-15 08:45:55,311] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:46:38,995] [1] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'pan_mri_mednext', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'nanaha1003'}
[2025-05-15 08:46:38,996] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /usr::/apps/radiology
[2025-05-15 08:46:38,997] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /usr::/apps/radiology
[2025-05-15 08:46:38,998] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /usr/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"pan_mri_mednext","name":"train_01","pretrained":true,"device":"Tesla P100-PCIE-16GB:0","max_epochs":100,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":2,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":"SmartCacheDataset","dataloader":"ThreadDataLoader","tracking":"mlflow","tracking_uri":"","tracking_experiment_name":"","client_id":"nanaha1003"}
[2025-05-15 08:46:39,460] [68] [MainThread] [INFO] (__main__:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:46:46,396] [68] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:46:46,614] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:46:46,614] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:46:46,615] [68] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:46:46,615] [68] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: False; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:46:46,631] [68] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:46:46,845] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f8e6b3ef160>
Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
[2025-05-15 08:46:46,852] [68] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-15 08:46:46,853] [timeloop] [INFO] Starting Timeloop..
[2025-05-15 08:46:46,853] [68] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:46:46,853] [timeloop] [INFO] Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f8e6a2d6cb0>
[2025-05-15 08:46:46,853] [68] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f8e6a2d6cb0>
[2025-05-15 08:46:46,853] [timeloop] [INFO] Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:46:46,853] [68] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
[2025-05-15 08:46:46,858] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f8e6b3ef160>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f8e6b3eebc0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f8e6b3eec20>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f8e6a4a4d00>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f8e6a4ebe50>}
[2025-05-15 08:46:46,989] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f8e6a7cef50>
[2025-05-15 08:46:46,990] [68] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-15 08:46:46,990] [68] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-15 08:46:46,990] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:436) - Train Request (input): {'model': 'pan_mri_mednext', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'nanaha1003', 'local_rank': 0}
[2025-05-15 08:46:46,990] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:449) - CUDA_VISIBLE_DEVICES: None
[2025-05-15 08:46:46,990] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:459) - Distributed/Multi GPU Training = TRUE
[2025-05-15 08:46:46,991] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:465) - Total proces to spawn: 2
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
[2025-05-15 08:46:54.373][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 0
[2025-05-15 08:46:54.373][ INFO](monailabel.tasks.train.basic_train) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pan_mri_mednext', 'client_id': 'nanaha1003', 'local_rank': 0, 'run_id': '20250515_084646'}
[2025-05-15 08:46:54.938][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 1
[2025-05-15 08:46:54.938][ INFO](monailabel.tasks.train.basic_train) - 1 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 2, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pan_mri_mednext', 'client_id': 'nanaha1003', 'local_rank': 0, 'run_id': '20250515_084646'}
[2025-05-15 08:46:55.008][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:0 => Using GPU-0
[2025-05-15 08:46:55.008][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:1 => Using GPU-1
[2025-05-15 08:46:55.058][ INFO](monailabel.tasks.train.basic_train) - 0 - Using Device: cuda:0; IDX: 0
[2025-05-15 08:46:55.058][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pan_mri_mednext/train_01
[2025-05-15 08:46:55.058][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-15 08:46:55.059][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pan_mri_mednext/train_01/mlruns;
[2025-05-15 08:46:55.059][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pan_mri_mednext; Run Name: run_20250515_084646
[2025-05-15 08:46:55.059][ INFO](monailabel.tasks.train.basic_train) - Total Records for Training: 3
[2025-05-15 08:46:55.059][ INFO](monailabel.tasks.train.basic_train) - Total Records for Validation: 1
[2025-05-15 08:46:55.484][ INFO](monailabel.tasks.train.basic_train) - 1 - Using Device: cuda:1; IDX: 1
[2025-05-15 08:46:55.484][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pan_mri_mednext/train_01
[2025-05-15 08:46:55.485][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-15 08:46:55.485][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pan_mri_mednext/train_01/mlruns;
[2025-05-15 08:46:55.485][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pan_mri_mednext; Run Name: run_20250515_084646
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 3305.20it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 7989.15it/s]
[2025-05-15 08:46:55.805][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Validation: 1
[2025-05-15 08:46:55.806][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Validation: 1
[2025-05-15 08:46:55.810][ INFO](monailabel.tasks.train.basic_train) - 1 - Adding Validation to run every '1' interval
[2025-05-15 08:46:55.811][ INFO](monailabel.tasks.train.basic_train) - 1 - Load Path /apps/radiology/model/best_model_pan.pt
[2025-05-15 08:46:55.815][ INFO](monailabel.tasks.train.basic_train) - 0 - Adding Validation to run every '1' interval
[2025-05-15 08:46:55.815][ INFO](monailabel.tasks.train.basic_train) - 0 - Load Path /apps/radiology/model/best_model_pan.pt
[2025-05-15 08:46:55.819][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7fe79b78d5d0> to <monai.transforms.compose.Compose object at 0x7fe799d5dc00>
Loading dataset:   0%|          | 0/2 [00:00<?, ?it/s][2025-05-15 08:46:55.823][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7f4d7663a320> to <monai.transforms.compose.Compose object at 0x7f4d766f8670>
Loading dataset:   0%|          | 0/2 [00:00<?, ?it/s]
Loading dataset:  50%|█████     | 1/2 [00:04<00:04,  4.46s/it]
Loading dataset: 100%|██████████| 2/2 [00:04<00:00,  2.23s/it]
[2025-05-15 08:47:00.284][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Training: 2
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-15 08:47:00.303][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-15 08:47:00.572][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/best_model_pan.pt
Loading dataset:  50%|█████     | 1/2 [00:05<00:05,  5.34s/it]
Loading dataset: 100%|██████████| 2/2 [00:05<00:00,  2.67s/it]
[2025-05-15 08:47:01.169][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Training: 2
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-15 08:47:01.183][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-15 08:47:01.388][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/best_model_pan.pt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
[2025-05-15 08:47:03.568][ERROR](ignite.engine.engine.SupervisedTrainer) - Current run is terminating due to exception: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-15 08:47:03,569 - ERROR - Exception: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 258, in _iteration
    _compute_pred_loss()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 250, in _compute_pred_loss
    engine.state.output[Keys.LOSS] = engine.loss_function(engine.state.output[Keys.PRED], targets).mean()
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/apps/radiology/custom/losses.py", line 11, in forward
    return super().forward(pred, label)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/ds_loss.py", line 80, in forward
    loss += weights[l] * self.get_loss(input[l].float(), target)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/ds_loss.py", line 73, in get_loss
    return self.loss(input, target)  # type: ignore[no-any-return]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/dice.py", line 804, in forward
    dice_loss = self.dice(input, target)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/dice.py", line 149, in forward
    input = torch.softmax(input, 1)
  File "/usr/local/lib/python3.10/dist-packages/monai/data/meta_tensor.py", line 282, in __torch_function__
    ret = super().__torch_function__(func, types, args, kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 1512, in __torch_function__
    ret = func(*args, **kwargs)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2025-05-15 08:47:03.575][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-05-15 08:47:03,575 - ERROR - Exception: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1087, in _run_once_on_dataset_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/stats_handler.py", line 201, in exception_raised
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 258, in _iteration
    _compute_pred_loss()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 250, in _compute_pred_loss
    engine.state.output[Keys.LOSS] = engine.loss_function(engine.state.output[Keys.PRED], targets).mean()
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/apps/radiology/custom/losses.py", line 11, in forward
    return super().forward(pred, label)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/ds_loss.py", line 80, in forward
    loss += weights[l] * self.get_loss(input[l].float(), target)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/ds_loss.py", line 73, in get_loss
    return self.loss(input, target)  # type: ignore[no-any-return]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/dice.py", line 804, in forward
    dice_loss = self.dice(input, target)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/dice.py", line 149, in forward
    input = torch.softmax(input, 1)
  File "/usr/local/lib/python3.10/dist-packages/monai/data/meta_tensor.py", line 282, in __torch_function__
    ret = super().__torch_function__(func, types, args, kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 1512, in __torch_function__
    ret = func(*args, **kwargs)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2025-05-15 08:47:04.070][ERROR](ignite.engine.engine.SupervisedTrainer) - Current run is terminating due to exception: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 1 has a total capacity of 15.89 GiB of which 465.12 MiB is free. Process 3439998 has 15.43 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.33 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2025-05-15 08:47:04.070][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 1 has a total capacity of 15.89 GiB of which 465.12 MiB is free. Process 3439998 has 15.43 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.33 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank0]:[W515 08:47:04.051213302 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
W0515 08:47:05.373000 68 local/lib/python3.10/dist-packages/torch/multiprocessing/spawn.py:160] Terminating process 143 via signal SIGTERM
-------------------------------------------------------------------------------
runpy.py 196 _run_module_as_main
return _run_code(code, main_globals, None,
runpy.py 86 _run_code
exec(code, run_globals)
app.py 128 <module>
run_main()
app.py 113 run_main
result = a.train(request)
app.py 423 train
result = task(request, self.datastore())
basic_train.py 466 __call__
torch.multiprocessing.spawn(main_worker, nprocs=world_size, args=(world_size, req, datalist, self))
spawn.py 328 spawn
return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
spawn.py 284 start_processes
while not context.join():
spawn.py 203 join
raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException:
-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 735, in main_worker
    task.train(rank, world_size, request, datalist)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 559, in train
    context.trainer.run()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 55, in run
    super().run()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 282, in run
    super().run(data=self.data_loader, max_epochs=self.state.max_epochs)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 892, in run
    return self._internal_run()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 935, in _internal_run
    return next(self._internal_run_generator)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 993, in _internal_run_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/stats_handler.py", line 201, in exception_raised
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1087, in _run_once_on_dataset_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/stats_handler.py", line 201, in exception_raised
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 258, in _iteration
    _compute_pred_loss()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 250, in _compute_pred_loss
    engine.state.output[Keys.LOSS] = engine.loss_function(engine.state.output[Keys.PRED], targets).mean()
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/apps/radiology/custom/losses.py", line 11, in forward
    return super().forward(pred, label)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/ds_loss.py", line 80, in forward
    loss += weights[l] * self.get_loss(input[l].float(), target)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/ds_loss.py", line 73, in get_loss
    return self.loss(input, target)  # type: ignore[no-any-return]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/dice.py", line 804, in forward
    dice_loss = self.dice(input, target)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/losses/dice.py", line 149, in forward
    input = torch.softmax(input, 1)
  File "/usr/local/lib/python3.10/dist-packages/monai/data/meta_tensor.py", line 282, in __torch_function__
    ret = super().__torch_function__(func, types, args, kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 1512, in __torch_function__
    ret = func(*args, **kwargs)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 512.00 MiB. GPU 0 has a total capacity of 15.89 GiB of which 475.12 MiB is free. Process 3439997 has 15.42 GiB memory in use. Of the allocated memory 12.75 GiB is allocated by PyTorch, and 2.32 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[2025-05-15 08:47:06,573] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2025-05-15 08:47:52,959] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:47:53,297] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:47:53,776] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:47:53,776] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:47:53,776] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:47:53,777] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:47:53,804] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:47:53,804] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-15 08:47:54,041] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fc931187d90>
[2025-05-15 08:47:54,051] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-15 08:47:54,052] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:47:54,052] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fc930443400>
[2025-05-15 08:47:54,053] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:47:54,058] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fc931187d90>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fc9311cc8e0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fc9311cc3a0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fc9303de830>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fc9305032e0>}
[2025-05-15 08:47:54,184] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fc9307f4640>
[2025-05-15 08:47:54,184] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-15 08:47:54,185] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-15 08:47:54,185] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-15 08:47:54,186] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:47:54,186] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fc930425750>
[2025-05-15 08:47:54,187] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:48:04,136] [1] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'pan_mri_mednext', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'nanaha1003'}
[2025-05-15 08:48:04,137] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /usr::/apps/radiology
[2025-05-15 08:48:04,138] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /usr::/apps/radiology
[2025-05-15 08:48:04,139] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /usr/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"pan_mri_mednext","name":"train_01","pretrained":true,"device":"Tesla P100-PCIE-16GB:0","max_epochs":100,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":"SmartCacheDataset","dataloader":"ThreadDataLoader","tracking":"mlflow","tracking_uri":"","tracking_experiment_name":"","client_id":"nanaha1003"}
[2025-05-15 08:48:04,595] [68] [MainThread] [INFO] (__main__:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pan.yaml'}
[2025-05-15 08:48:11,567] [68] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-15 08:48:11,784] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-15 08:48:11,784] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext']
[2025-05-15 08:48:11,785] [68] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-15 08:48:11,785] [68] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: False; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-15 08:48:11,795] [68] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-15 08:48:12,012] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f051ca77370>
Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
[2025-05-15 08:48:12,019] [68] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-15 08:48:12,019] [timeloop] [INFO] Starting Timeloop..
[2025-05-15 08:48:12,019] [68] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-15 08:48:12,020] [timeloop] [INFO] Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f051b956cb0>
[2025-05-15 08:48:12,020] [68] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f051b956cb0>
[2025-05-15 08:48:12,020] [timeloop] [INFO] Timeloop now started. Jobs will run based on the interval set
[2025-05-15 08:48:12,020] [68] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
[2025-05-15 08:48:12,024] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f051ca77370>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f051ca76dd0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f051ca76e30>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f051bb4fd90>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f051bb4fd60>}
[2025-05-15 08:48:12,153] [68] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f051bb4fd00>
[2025-05-15 08:48:12,153] [68] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-15 08:48:12,153] [68] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-15 08:48:12,153] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:436) - Train Request (input): {'model': 'pan_mri_mednext', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'nanaha1003', 'local_rank': 0}
[2025-05-15 08:48:12,154] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:449) - CUDA_VISIBLE_DEVICES: None
[2025-05-15 08:48:12,154] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:459) - Distributed/Multi GPU Training = TRUE
[2025-05-15 08:48:12,154] [68] [MainThread] [INFO] (monailabel.tasks.train.basic_train:465) - Total proces to spawn: 2
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
[2025-05-15 08:48:19.795][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 0
[2025-05-15 08:48:19.795][ INFO](monailabel.tasks.train.basic_train) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pan_mri_mednext', 'client_id': 'nanaha1003', 'local_rank': 0, 'run_id': '20250515_084812'}
[2025-05-15 08:48:20.223][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 1
[2025-05-15 08:48:20.223][ INFO](monailabel.tasks.train.basic_train) - 1 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pan_mri_mednext', 'client_id': 'nanaha1003', 'local_rank': 0, 'run_id': '20250515_084812'}
[2025-05-15 08:48:20.290][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:1 => Using GPU-1
[2025-05-15 08:48:20.290][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:0 => Using GPU-0
[2025-05-15 08:48:20.343][ INFO](monailabel.tasks.train.basic_train) - 0 - Using Device: cuda:0; IDX: 0
[2025-05-15 08:48:20.343][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pan_mri_mednext/train_01
[2025-05-15 08:48:20.343][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-15 08:48:20.343][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pan_mri_mednext/train_01/mlruns;
[2025-05-15 08:48:20.343][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pan_mri_mednext; Run Name: run_20250515_084812
[2025-05-15 08:48:20.344][ INFO](monailabel.tasks.train.basic_train) - Total Records for Training: 3
[2025-05-15 08:48:20.344][ INFO](monailabel.tasks.train.basic_train) - Total Records for Validation: 1
[2025-05-15 08:48:20.718][ INFO](monailabel.tasks.train.basic_train) - 1 - Using Device: cuda:1; IDX: 1
[2025-05-15 08:48:20.718][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pan_mri_mednext/train_01
[2025-05-15 08:48:20.718][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-15 08:48:20.718][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pan_mri_mednext/train_01/mlruns;
[2025-05-15 08:48:20.718][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pan_mri_mednext; Run Name: run_20250515_084812
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 4917.12it/s]
[2025-05-15 08:48:21.020][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Validation: 1
[2025-05-15 08:48:21.028][ INFO](monailabel.tasks.train.basic_train) - 0 - Adding Validation to run every '1' interval
[2025-05-15 08:48:21.029][ INFO](monailabel.tasks.train.basic_train) - 0 - Load Path /apps/radiology/model/best_model_pan.pt
[2025-05-15 08:48:21.036][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7f0d2c4c63e0> to <monai.transforms.compose.Compose object at 0x7f0d2c304730>
Loading dataset:   0%|          | 0/2 [00:00<?, ?it/s]
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 2387.20it/s]
[2025-05-15 08:48:21.041][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Validation: 1
[2025-05-15 08:48:21.048][ INFO](monailabel.tasks.train.basic_train) - 1 - Adding Validation to run every '1' interval
[2025-05-15 08:48:21.048][ INFO](monailabel.tasks.train.basic_train) - 1 - Load Path /apps/radiology/model/best_model_pan.pt
[2025-05-15 08:48:21.056][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7f3c68d45780> to <monai.transforms.compose.Compose object at 0x7f3c68dd9db0>
Loading dataset:   0%|          | 0/2 [00:00<?, ?it/s]
Loading dataset:  50%|█████     | 1/2 [00:04<00:04,  4.37s/it]
Loading dataset: 100%|██████████| 2/2 [00:04<00:00,  2.18s/it]
[2025-05-15 08:48:25.409][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Training: 2
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-15 08:48:25.425][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-15 08:48:25.689][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/best_model_pan.pt
Loading dataset:  50%|█████     | 1/2 [00:05<00:05,  5.00s/it]
Loading dataset: 100%|██████████| 2/2 [00:05<00:00,  2.50s/it]
[2025-05-15 08:48:26.061][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Training: 2
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-15 08:48:26.081][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-15 08:48:26.290][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/best_model_pan.pt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
2025-05-15 08:48:34,303 - INFO - Epoch: 1/100, Iter: 1/2 -- train_loss: 1.6365
2025-05-15 08:48:38,410 - INFO - Epoch: 1/100, Iter: 2/2 -- train_loss: 1.9644
[2025-05-15 08:48:38.480][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.3429233431816101
[2025-05-15 08:48:38.481][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0009997533048548475
[2025-05-15 08:48:38.481][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 0 until 1 epochs
[2025-05-15 08:48:38.490][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.3429233431816101
[2025-05-15 08:48:38.490][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0009997533048548475
2025-05-15 08:48:38,490 - INFO - Epoch[1] Metrics -- train_mean_dice: 0.3429
2025-05-15 08:48:38,490 - INFO - Key metric: train_mean_dice best value: 0.3429233431816101 at epoch: 1
[2025-05-15 08:48:38.494][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 0 until 1 epochs
[2025-05-15 08:48:45.519][ INFO](ignite.engine.engine.SupervisedEvaluator) - Got new best metric of val_mean_dice: 0.9111013412475586
[2025-05-15 08:48:45.519][ INFO](ignite.engine.engine.SupervisedEvaluator) - Got new best metric of val_mean_dice: 0.9111013412475586
2025-05-15 08:48:45,520 - INFO - Epoch[1] Metrics -- val_mean_dice: 0.9111
[2025-05-15 08:48:45.520][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[1] Complete. Time taken: 00:00:07.039
2025-05-15 08:48:45,520 - INFO - Key metric: val_mean_dice best value: 0.9111013412475586 at epoch: 1
[2025-05-15 08:48:45.520][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:07.039
[2025-05-15 08:48:45.520][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[1] Complete. Time taken: 00:00:19.228
[2025-05-15 08:48:46.307][ INFO](monailabel.tasks.train.handler) - New Model published: /apps/radiology/model/pan_mri_mednext/train_01/best_model.ckpt => /apps/radiology/model/pan_mri_mednext.ckpt
[2025-05-15 08:48:46.307][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[1] Complete. Time taken: 00:00:07.782
[2025-05-15 08:48:46.314][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:07.820
[2025-05-15 08:48:46.713][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[1] Complete. Time taken: 00:00:21.023
2025-05-15 08:48:50,578 - INFO - Epoch: 2/100, Iter: 1/2 -- train_loss: 1.6422
2025-05-15 08:48:52,281 - INFO - Epoch: 2/100, Iter: 2/2 -- train_loss: 2.4867
[2025-05-15 08:48:52.291][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.44678211212158203
[2025-05-15 08:48:52.291][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.44678211212158203
[2025-05-15 08:48:52.292][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0009990134628777144
[2025-05-15 08:48:52.292][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0009990134628777144
[2025-05-15 08:48:52.292][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 1 until 2 epochs
2025-05-15 08:48:52,292 - INFO - Epoch[2] Metrics -- train_mean_dice: 0.4468
2025-05-15 08:48:52,292 - INFO - Key metric: train_mean_dice best value: 0.44678211212158203 at epoch: 2
[2025-05-15 08:48:52.296][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 1 until 2 epochs
[2025-05-15 08:48:59.082][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[2] Complete. Time taken: 00:00:06.790
[2025-05-15 08:48:59.083][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:06.791
[2025-05-15 08:48:59.083][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[2] Complete. Time taken: 00:00:13.563
2025-05-15 08:48:59,083 - INFO - Epoch[2] Metrics -- val_mean_dice: 0.9039
2025-05-15 08:48:59,083 - INFO - Key metric: val_mean_dice best value: 0.9111013412475586 at epoch: 1
[2025-05-15 08:48:59.460][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[2] Complete. Time taken: 00:00:07.121
[2025-05-15 08:48:59.463][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:07.167
[2025-05-15 08:48:59.877][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[2] Complete. Time taken: 00:00:13.163
2025-05-15 08:49:01,810 - INFO - Epoch: 3/100, Iter: 1/2 -- train_loss: 1.7023
2025-05-15 08:49:06,743 - INFO - Epoch: 3/100, Iter: 2/2 -- train_loss: 2.8311
[2025-05-15 08:49:06.757][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00099778120420331
[2025-05-15 08:49:06.757][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 2 until 3 epochs
[2025-05-15 08:49:06.757][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00099778120420331
2025-05-15 08:49:06,757 - INFO - Epoch[3] Metrics -- train_mean_dice: 0.4279
2025-05-15 08:49:06,757 - INFO - Key metric: train_mean_dice best value: 0.44678211212158203 at epoch: 2
[2025-05-15 08:49:06.761][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 2 until 3 epochs
[2025-05-15 08:49:13.508][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[3] Complete. Time taken: 00:00:06.751
[2025-05-15 08:49:13.508][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:06.751
2025-05-15 08:49:13,508 - INFO - Epoch[3] Metrics -- val_mean_dice: 0.9026
[2025-05-15 08:49:13.509][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[3] Complete. Time taken: 00:00:14.426
2025-05-15 08:49:13,509 - INFO - Key metric: val_mean_dice best value: 0.9111013412475586 at epoch: 1
[2025-05-15 08:49:13.517][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[3] Complete. Time taken: 00:00:06.704
[2025-05-15 08:49:13.521][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:06.760
[2025-05-15 08:49:13.522][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[3] Complete. Time taken: 00:00:13.643
2025-05-15 08:49:15,622 - INFO - Epoch: 4/100, Iter: 1/2 -- train_loss: 1.5854
2025-05-15 08:49:19,055 - INFO - Epoch: 4/100, Iter: 2/2 -- train_loss: 3.6714
[2025-05-15 08:49:19.066][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.46010223031044006
[2025-05-15 08:49:19.066][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0009960577449221735
[2025-05-15 08:49:19.066][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.46010223031044006
[2025-05-15 08:49:19.066][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 3 until 4 epochs
[2025-05-15 08:49:19.067][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0009960577449221735
2025-05-15 08:49:19,067 - INFO - Epoch[4] Metrics -- train_mean_dice: 0.4601
2025-05-15 08:49:19,067 - INFO - Key metric: train_mean_dice best value: 0.46010223031044006 at epoch: 4
[2025-05-15 08:49:19.071][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 3 until 4 epochs
[2025-05-15 08:49:25.712][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[4] Complete. Time taken: 00:00:06.645
[2025-05-15 08:49:25.712][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:06.646
2025-05-15 08:49:25,712 - INFO - Epoch[4] Metrics -- val_mean_dice: 0.9017
[2025-05-15 08:49:25.713][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[4] Complete. Time taken: 00:00:12.204
2025-05-15 08:49:25,713 - INFO - Key metric: val_mean_dice best value: 0.9111013412475586 at epoch: 1
[2025-05-15 08:49:25.724][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[4] Complete. Time taken: 00:00:06.596
[2025-05-15 08:49:25.727][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:06.656
[2025-05-15 08:49:26.139][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[4] Complete. Time taken: 00:00:12.617
2025-05-15 08:49:31,315 - INFO - Epoch: 5/100, Iter: 1/2 -- train_loss: 2.0171
-------------------------------------------------------------------------------
runpy.py 196 _run_module_as_main
return _run_code(code, main_globals, None,
runpy.py 86 _run_code
exec(code, run_globals)
app.py 128 <module>
run_main()
app.py 113 run_main
result = a.train(request)
app.py 423 train
result = task(request, self.datastore())
basic_train.py 466 __call__
torch.multiprocessing.spawn(main_worker, nprocs=world_size, args=(world_size, req, datalist, self))
spawn.py 328 spawn
return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
spawn.py 284 start_processes
while not context.join():
spawn.py 132 join
ready = multiprocessing.connection.wait(
connection.py 931 wait
ready = selector.select(timeout)
selectors.py 416 select
fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
[2025-05-15 08:49:35.039][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception:
2025-05-15 08:49:35,039 - ERROR - Exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1032, in _run_once_on_dataset_as_gen
    self.state.batch = next(self._dataloader_iter)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.10/dist-packages/monai/data/dataset.py", line 108, in __getitem__
    return self._transform(index)
  File "/usr/local/lib/python3.10/dist-packages/manafaln/data/dataset.py", line 237, in _transform
    return self.cache[index].get_data(self.transform)
  File "/usr/local/lib/python3.10/dist-packages/manafaln/data/dataset.py", line 122, in get_data
    data = transform(data, start=self.transform_index)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 335, in __call__
    result = execute_compose(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 111, in execute_compose
    data = apply_transform(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/spatial/dictionary.py", line 1885, in __call__
    d[key] = self.rand_rotate(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/spatial/array.py", line 1384, in __call__
    out = rotator(img)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/spatial/array.py", line 959, in __call__
    return rotate(  # type: ignore
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/spatial/functional.py", line 408, in rotate
    output: torch.Tensor = xform(img_t.unsqueeze(0), transform_t, spatial_size=tuple(int(i) for i in output_shape))
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/layers/spatial_transforms.py", line 585, in forward
    dst = nn.functional.grid_sample(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 4863, in grid_sample
    return handle_torch_function(
  File "/usr/local/lib/python3.10/dist-packages/torch/overrides.py", line 1739, in handle_torch_function
    result = torch_func_method(public_api, types, args, kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/data/meta_tensor.py", line 282, in __torch_function__
    ret = super().__torch_function__(func, types, args, kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 1512, in __torch_function__
    ret = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 4910, in grid_sample
    return torch.grid_sampler(input, grid, mode_enum, padding_mode_enum, align_corners)
KeyboardInterrupt
[rank0]:[W515 08:49:35.796854891 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
Exception ignored in atexit callback: <function _exit_function at 0x7f05947a2440>
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/util.py", line 357, in _exit_function
    p.join()
  File "/usr/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
[2025-05-16 03:22:20,364] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 03:22:20,697] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 03:22:21,117] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 03:22:21,117] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 03:22:21,118] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 03:22:21,118] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 03:22:21,138] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 6 => 6.nii.gz
[2025-05-16 03:22:21,139] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 7 => 7.nii.gz
[2025-05-16 03:22:21,139] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 5 => 5.nii.gz
[2025-05-16 03:22:21,140] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 23 => 23.nii.gz
[2025-05-16 03:22:21,141] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 18 => 18.nii.gz
[2025-05-16 03:22:21,141] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 34 => 34.nii.gz
[2025-05-16 03:22:21,142] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 35 => 35.nii.gz
[2025-05-16 03:22:21,143] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 2 => 2.nii.gz
[2025-05-16 03:22:21,143] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 14 => 14.nii.gz
[2025-05-16 03:22:21,144] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 42 => 42.nii.gz
[2025-05-16 03:22:21,145] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 20 => 20.nii.gz
[2025-05-16 03:22:21,145] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 4 => 4.nii.gz
[2025-05-16 03:22:21,146] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 36 => 36.nii.gz
[2025-05-16 03:22:21,146] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 49 => 49.nii.gz
[2025-05-16 03:22:21,147] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 22 => 22.nii.gz
[2025-05-16 03:22:21,148] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 43 => 43.nii.gz
[2025-05-16 03:22:21,148] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 21 => 21.nii.gz
[2025-05-16 03:22:21,149] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 37 => 37.nii.gz
[2025-05-16 03:22:21,149] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 17 => 17.nii.gz
[2025-05-16 03:22:21,150] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 9 => 9.nii.gz
[2025-05-16 03:22:21,151] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 40 => 40.nii.gz
[2025-05-16 03:22:21,151] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 33 => 33.nii.gz
[2025-05-16 03:22:21,152] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 13 => 13.nii.gz
[2025-05-16 03:22:21,152] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 39 => 39.nii.gz
[2025-05-16 03:22:21,153] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 19 => 19.nii.gz
[2025-05-16 03:22:21,154] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 46 => 46.nii.gz
[2025-05-16 03:22:21,154] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 26 => 26.nii.gz
[2025-05-16 03:22:21,155] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 10 => 10.nii.gz
[2025-05-16 03:22:21,156] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 47 => 47.nii.gz
[2025-05-16 03:22:21,156] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 38 => 38.nii.gz
[2025-05-16 03:22:21,157] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 50 => 50.nii.gz
[2025-05-16 03:22:21,157] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 1 => 1.nii.gz
[2025-05-16 03:22:21,158] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 24 => 24.nii.gz
[2025-05-16 03:22:21,159] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 15 => 15.nii.gz
[2025-05-16 03:22:21,159] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 41 => 41.nii.gz
[2025-05-16 03:22:21,160] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 25 => 25.nii.gz
[2025-05-16 03:22:21,160] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 32 => 32.nii.gz
[2025-05-16 03:22:21,161] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 45 => 45.nii.gz
[2025-05-16 03:22:21,162] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 44 => 44.nii.gz
[2025-05-16 03:22:21,162] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 28 => 28.nii.gz
[2025-05-16 03:22:21,163] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 30 => 30.nii.gz
[2025-05-16 03:22:21,164] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 12 => 12.nii.gz
[2025-05-16 03:22:21,164] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 29 => 29.nii.gz
[2025-05-16 03:22:21,165] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 8 => 8.nii.gz
[2025-05-16 03:22:21,165] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 16 => 16.nii.gz
[2025-05-16 03:22:21,166] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 3 => 3.nii.gz
[2025-05-16 03:22:21,167] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 27 => 27.nii.gz
[2025-05-16 03:22:21,167] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 31 => 31.nii.gz
[2025-05-16 03:22:21,168] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 48 => 48.nii.gz
[2025-05-16 03:22:21,168] [1] [MainThread] [INFO] (monailabel.datastore.local:594) - Adding New Image: 11 => 11.nii.gz
[2025-05-16 03:22:21,184] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 50
[2025-05-16 03:22:21,187] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 03:22:22,329] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f9071b8a4a0>
[2025-05-16 03:22:22,336] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 03:22:22,337] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:22:22,337] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f90695ea5f0>
[2025-05-16 03:22:22,338] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:22:22,343] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f9071b8a4a0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f9071b8a020>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f9071b8a560>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f9070f7a2c0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f9070cb7220>}
[2025-05-16 03:22:22,408] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f90695c3af0>
[2025-05-16 03:22:22,409] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 03:22:22,409] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 03:22:22,410] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 03:22:22,411] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:22:22,411] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f9068304d30>
[2025-05-16 03:22:22,412] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:23:00,229] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 03:23:00,231] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 7; Weight: 1747365780
[2025-05-16 03:23:00,236] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '7', 'weight': 1747365780, 'path': '/data/7.nii.gz', 'ts': 1747365741, 'name': '7.nii.gz'}
[2025-05-16 03:23:17,137] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '7', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 03:23:17,138] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/7.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 03:23:17,156] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 03:23:17,156] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 03:23:18,171] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.0138; image: torch.Size([512, 512, 94])(torch.float32)
[2025-05-16 03:23:18,172] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0009; image: torch.Size([1, 512, 512, 94])(torch.float32)
[2025-05-16 03:23:18,193] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0199; image: torch.Size([1, 512, 512, 94])(torch.float32)
[2025-05-16 03:23:18,280] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0867; image: torch.Size([1, 512, 512, 94])(torch.float32)
[2025-05-16 03:23:19,834] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.5535; image: torch.Size([1, 276, 276, 311])(torch.float32)
[2025-05-16 03:23:19,871] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityd): Time: 0.0373; image: torch.Size([1, 276, 276, 311])(torch.float32)
[2025-05-16 03:23:19,872] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 276, 276, 311])(torch.float32)
[2025-05-16 03:23:19,874] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 03:23:19,874] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 03:28:09,530] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 03:28:10,138] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 03:28:10,734] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 03:28:10,735] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 03:28:10,735] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 03:28:10,736] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 03:28:10,762] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 03:28:10,762] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 03:28:12,369] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f08ab74ff10>
[2025-05-16 03:28:12,400] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 03:28:12,400] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:28:12,401] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f089b19a5f0>
[2025-05-16 03:28:12,401] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:28:12,445] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f08ab74ff10>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f08ab74f970>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f08ab74f9d0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f089b3437c0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f08aa8d6950>}
[2025-05-16 03:28:12,509] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f08aad8bc70>
[2025-05-16 03:28:12,509] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 03:28:12,510] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 03:28:12,510] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 03:28:12,511] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:28:12,512] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f089b1acd30>
[2025-05-16 03:28:12,512] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:28:34,874] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 03:28:34,877] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 40; Weight: 1747366114
[2025-05-16 03:28:34,882] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '40', 'weight': 1747366114, 'path': '/data/40.nii.gz', 'ts': 1747365741, 'name': '40.nii.gz'}
[2025-05-16 03:28:55,580] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '40', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 03:28:55,582] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/40.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 03:28:55,605] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 03:28:55,605] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 03:28:56,864] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.2567; image: torch.Size([512, 512, 90])(torch.float32)
[2025-05-16 03:28:56,885] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.021; image: torch.Size([1, 512, 512, 90])(torch.float32)
[2025-05-16 03:28:57,023] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.1376; image: torch.Size([1, 512, 512, 90])(torch.float32)
[2025-05-16 03:28:57,242] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.2176; image: torch.Size([1, 512, 512, 90])(torch.float32)
[2025-05-16 03:28:59,265] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 2.0226; image: torch.Size([1, 282, 282, 298])(torch.float32)
[2025-05-16 03:28:59,321] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityd): Time: 0.0559; image: torch.Size([1, 282, 282, 298])(torch.float32)
[2025-05-16 03:28:59,321] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 282, 282, 298])(torch.float32)
[2025-05-16 03:28:59,324] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 03:28:59,324] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 03:32:21,295] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 03:32:21,627] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 03:32:22,052] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 03:32:22,052] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 03:32:22,052] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 03:32:22,053] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 03:32:22,076] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 03:32:22,076] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 03:32:23,193] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f4820e63190>
[2025-05-16 03:32:23,200] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 03:32:23,200] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:32:23,201] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f481c8d65f0>
[2025-05-16 03:32:23,201] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:32:23,207] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f4820e63190>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f4820e62d10>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f4820e63250>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f4820246fb0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f481ff93cd0>}
[2025-05-16 03:32:23,274] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f481c8abfd0>
[2025-05-16 03:32:23,274] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 03:32:23,275] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 03:32:23,276] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 03:32:23,277] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:32:23,277] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f481c8f0d30>
[2025-05-16 03:32:23,278] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:32:38,662] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 03:32:38,666] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 34; Weight: 1747366358
[2025-05-16 03:32:38,671] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '34', 'weight': 1747366358, 'path': '/data/34.nii.gz', 'ts': 1747365741, 'name': '34.nii.gz'}
[2025-05-16 03:36:09,167] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 03:36:09,500] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 03:36:09,920] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 03:36:09,920] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 03:36:09,921] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 03:36:09,922] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 03:36:09,936] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 03:36:09,936] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 03:36:11,052] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f7812328a60>
[2025-05-16 03:36:11,059] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 03:36:11,059] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:36:11,060] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f7809eca5f0>
[2025-05-16 03:36:11,060] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:36:11,066] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f7812328a60>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f78123285e0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f7812328b20>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f7809e89e70>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f781165b520>}
[2025-05-16 03:36:11,131] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f7811950880>
[2025-05-16 03:36:11,131] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 03:36:11,132] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 03:36:11,132] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 03:36:11,133] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 03:36:11,134] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f7809edcd30>
[2025-05-16 03:36:11,134] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 03:36:51,599] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 03:36:51,602] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 37; Weight: 1747366611
[2025-05-16 03:36:51,710] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '37', 'weight': 1747366611, 'path': '/data/37.nii.gz', 'ts': 1747365741, 'name': '37.nii.gz'}
[2025-05-16 03:36:59,043] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '37', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 03:36:59,044] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/37.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 03:36:59,062] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 03:36:59,062] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 03:37:00,018] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.9553; image: torch.Size([512, 512, 90])(torch.float32)
[2025-05-16 03:37:00,020] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.001; image: torch.Size([1, 512, 512, 90])(torch.float32)
[2025-05-16 03:37:00,040] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0197; image: torch.Size([1, 512, 512, 90])(torch.float32)
[2025-05-16 03:37:00,124] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0842; image: torch.Size([1, 512, 512, 90])(torch.float32)
[2025-05-16 03:37:01,285] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.1606; image: torch.Size([1, 241, 241, 298])(torch.float32)
[2025-05-16 03:37:01,286] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 241, 241, 298])(torch.float32)
[2025-05-16 03:37:01,288] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 03:37:01,288] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:05:10,836] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:05:11,173] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:05:11,624] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:05:11,624] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:05:11,625] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:05:11,626] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:05:11,648] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:05:11,648] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:09:41,006] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:09:41,361] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:09:41,860] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:09:41,860] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:09:41,861] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:09:41,862] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:09:41,885] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:09:41,885] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:09:42,023] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7efacd6a0880>
[2025-05-16 05:09:42,031] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:09:42,031] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:09:42,032] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7efacc0da560>
[2025-05-16 05:09:42,032] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:09:42,038] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7efacd6a0880>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7efacd6a0400>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7efacd6a0940>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7efacc0bc9a0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7efacc9d7340>}
[2025-05-16 05:09:42,105] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7efacccc86a0>
[2025-05-16 05:09:42,106] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:09:42,106] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:09:42,107] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 05:09:42,108] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:09:42,109] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7efacc0e88b0>
[2025-05-16 05:09:42,109] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:09:57,407] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 05:09:57,409] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 50; Weight: 1747372197
[2025-05-16 05:09:57,414] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '50', 'weight': 1747372197, 'path': '/data/50.nii.gz', 'ts': 1747365741, 'name': '50.nii.gz'}
[2025-05-16 05:10:10,895] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '50', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 05:10:10,898] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/50.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 05:10:10,918] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 05:10:10,919] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 05:10:11,886] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.9662; image: torch.Size([512, 512, 85])(torch.float32)
[2025-05-16 05:10:11,888] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0011; image: torch.Size([1, 512, 512, 85])(torch.float32)
[2025-05-16 05:10:11,912] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0234; image: torch.Size([1, 512, 512, 85])(torch.float32)
[2025-05-16 05:10:11,999] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0865; image: torch.Size([1, 512, 512, 85])(torch.float32)
[2025-05-16 05:10:13,510] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.5109; image: torch.Size([1, 287, 287, 281])(torch.float32)
[2025-05-16 05:10:13,510] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 287, 287, 281])(torch.float32)
[2025-05-16 05:10:13,513] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 05:10:13,513] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:10:13,939] [1] [MainThread] [WARNING] (monailabel.tasks.infer.basic_infer:471) - Checkpoint keys don't match network.state_dict()! Items that exist in only one dict but not in the other: {'backbone._orig_mod.down_layers.0.1.conv2.conv.weight', 'down_layers.1.2.norm2.weight', 'backbone._orig_mod.down_layers.3.1.norm1.weight', 'backbone._orig_mod.down_layers.2.2.norm1.bias', 'up_layers.1.0.norm1.bias', 'backbone._orig_mod.down_layers.1.2.norm1.bias', 'backbone._orig_mod.up_layers.2.0.norm2.bias', 'backbone._orig_mod.up_samples.2.0.conv.weight', 'down_layers.2.2.norm1.weight', 'backbone._orig_mod.up_layers.0.0.norm1.bias', 'convInit.conv.weight', 'down_layers.3.3.norm1.weight', 'backbone._orig_mod.conv_final.2.conv.weight', 'backbone._orig_mod.down_layers.1.1.conv2.conv.weight', 'down_layers.2.1.norm1.bias', 'down_layers.2.0.conv.weight', 'down_layers.3.1.norm2.bias', 'backbone._orig_mod.down_layers.2.1.conv2.conv.weight', 'down_layers.1.2.norm1.weight', 'down_layers.2.1.norm2.weight', 'backbone._orig_mod.conv_final.2.conv.bias', 'conv_final.2.conv.bias', 'down_layers.3.2.norm1.weight', 'down_layers.3.1.norm2.weight', 'backbone._orig_mod.down_layers.1.1.norm1.weight', 'backbone._orig_mod.down_layers.3.3.norm1.bias', 'down_layers.3.3.norm2.bias', 'backbone._orig_mod.down_layers.3.1.norm2.weight', 'up_layers.0.0.norm1.weight', 'down_layers.1.2.conv1.conv.weight', 'up_layers.1.0.norm2.weight', 'backbone._orig_mod.down_layers.2.2.norm2.bias', 'down_layers.3.4.conv2.conv.weight', 'backbone._orig_mod.down_layers.1.2.conv1.conv.weight', 'backbone._orig_mod.down_layers.2.2.conv2.conv.weight', 'conv_final.0.bias', 'up_samples.0.0.conv.weight', 'down_layers.2.2.norm1.bias', 'down_layers.2.2.norm2.weight', 'backbone._orig_mod.down_layers.0.1.norm2.weight', 'backbone._orig_mod.down_layers.1.2.norm2.bias', 'up_layers.2.0.conv1.conv.weight', 'down_layers.2.1.norm1.weight', 'backbone._orig_mod.down_layers.2.2.conv1.conv.weight', 'backbone._orig_mod.down_layers.3.1.conv2.conv.weight', 'down_layers.2.2.conv1.conv.weight', 'down_layers.1.1.norm2.bias', 'backbone._orig_mod.down_layers.3.4.conv1.conv.weight', 'backbone._orig_mod.down_layers.0.1.conv1.conv.weight', 'backbone._orig_mod.down_layers.1.1.norm2.weight', 'up_layers.1.0.norm1.weight', 'backbone._orig_mod.up_layers.0.0.conv2.conv.weight', 'down_layers.3.2.conv1.conv.weight', 'up_layers.1.0.conv2.conv.weight', 'backbone._orig_mod.down_layers.3.2.norm1.bias', 'down_layers.1.1.norm1.bias', 'backbone._orig_mod.up_layers.0.0.conv1.conv.weight', 'backbone._orig_mod.down_layers.1.2.conv2.conv.weight', 'up_layers.1.0.norm2.bias', 'up_layers.0.0.norm1.bias', 'backbone._orig_mod.up_layers.2.0.conv2.conv.weight', 'backbone._orig_mod.up_layers.1.0.conv1.conv.weight', 'backbone._orig_mod.down_layers.3.1.norm1.bias', 'backbone._orig_mod.conv_final.0.weight', 'backbone._orig_mod.up_layers.0.0.norm1.weight', 'down_layers.3.4.norm2.bias', 'backbone._orig_mod.convInit.conv.weight', 'backbone._orig_mod.up_layers.1.0.norm1.bias', 'down_layers.3.3.norm1.bias', 'down_layers.3.0.conv.weight', 'down_layers.1.2.norm1.bias', 'up_layers.2.0.norm1.bias', 'down_layers.0.1.conv1.conv.weight', 'backbone._orig_mod.up_layers.2.0.norm1.bias', 'backbone._orig_mod.down_layers.3.2.conv2.conv.weight', 'down_layers.1.1.conv2.conv.weight', 'backbone._orig_mod.up_layers.0.0.norm2.bias', 'up_samples.2.0.conv.weight', 'down_layers.2.1.norm2.bias', 'up_layers.2.0.conv2.conv.weight', 'backbone._orig_mod.down_layers.0.1.norm1.bias', 'down_layers.0.1.norm2.weight', 'down_layers.3.4.norm1.bias', 'down_layers.1.1.conv1.conv.weight', 'backbone._orig_mod.down_layers.3.3.norm2.bias', 'conv_final.2.conv.weight', 'backbone._orig_mod.down_layers.1.2.norm1.weight', 'backbone._orig_mod.down_layers.3.4.norm2.weight', 'backbone._orig_mod.down_layers.3.4.norm1.weight', 'down_layers.3.1.norm1.bias', 'down_layers.3.3.conv1.conv.weight', 'down_layers.1.0.conv.weight', 'backbone._orig_mod.up_layers.0.0.norm2.weight', 'backbone._orig_mod.up_layers.2.0.norm1.weight', 'up_layers.2.0.norm2.bias', 'backbone._orig_mod.down_layers.3.1.conv1.conv.weight', 'backbone._orig_mod.up_samples.0.0.conv.weight', 'down_layers.1.2.norm2.bias', 'down_layers.3.2.norm2.weight', 'conv_final.0.weight', 'backbone._orig_mod.down_layers.2.1.norm1.bias', 'backbone._orig_mod.up_samples.1.0.conv.weight', 'down_layers.3.3.conv2.conv.weight', 'down_layers.2.1.conv1.conv.weight', 'down_layers.3.3.norm2.weight', 'up_layers.1.0.conv1.conv.weight', 'down_layers.3.2.norm2.bias', 'backbone._orig_mod.up_layers.1.0.conv2.conv.weight', 'down_layers.3.4.norm1.weight', 'down_layers.3.2.norm1.bias', 'backbone._orig_mod.down_layers.2.2.norm1.weight', 'backbone._orig_mod.conv_final.0.bias', 'backbone._orig_mod.up_layers.1.0.norm1.weight', 'down_layers.0.1.norm2.bias', 'down_layers.3.4.norm2.weight', 'backbone._orig_mod.down_layers.3.3.conv2.conv.weight', 'down_layers.2.1.conv2.conv.weight', 'backbone._orig_mod.down_layers.3.0.conv.weight', 'backbone._orig_mod.up_layers.2.0.conv1.conv.weight', 'backbone._orig_mod.down_layers.0.1.norm1.weight', 'backbone._orig_mod.down_layers.2.1.norm2.bias', 'backbone._orig_mod.down_layers.3.1.norm2.bias', 'down_layers.3.4.conv1.conv.weight', 'down_layers.0.1.norm1.weight', 'backbone._orig_mod.down_layers.3.2.norm2.bias', 'backbone._orig_mod.down_layers.2.2.norm2.weight', 'backbone._orig_mod.down_layers.3.4.conv2.conv.weight', 'backbone._orig_mod.down_layers.3.3.norm2.weight', 'backbone._orig_mod.up_layers.1.0.norm2.bias', 'up_layers.2.0.norm1.weight', 'up_samples.1.0.conv.weight', 'down_layers.1.2.conv2.conv.weight', 'down_layers.3.1.conv1.conv.weight', 'down_layers.1.1.norm2.weight', 'backbone._orig_mod.down_layers.3.3.conv1.conv.weight', 'backbone._orig_mod.down_layers.1.2.norm2.weight', 'down_layers.2.2.conv2.conv.weight', 'down_layers.1.1.norm1.weight', 'backbone._orig_mod.down_layers.3.2.conv1.conv.weight', 'down_layers.3.1.conv2.conv.weight', 'backbone._orig_mod.down_layers.3.2.norm2.weight', 'down_layers.2.2.norm2.bias', 'backbone._orig_mod.down_layers.0.1.norm2.bias', 'backbone._orig_mod.down_layers.3.2.norm1.weight', 'down_layers.0.1.norm1.bias', 'backbone._orig_mod.down_layers.1.1.conv1.conv.weight', 'up_layers.0.0.norm2.bias', 'backbone._orig_mod.down_layers.1.1.norm1.bias', 'up_layers.2.0.norm2.weight', 'backbone._orig_mod.down_layers.2.1.norm2.weight', 'backbone._orig_mod.up_layers.1.0.norm2.weight', 'backbone._orig_mod.up_layers.2.0.norm2.weight', 'backbone._orig_mod.down_layers.3.4.norm2.bias', 'down_layers.0.1.conv2.conv.weight', 'up_layers.0.0.conv1.conv.weight', 'up_layers.0.0.conv2.conv.weight', 'backbone._orig_mod.down_layers.2.0.conv.weight', 'backbone._orig_mod.down_layers.2.1.conv1.conv.weight', 'down_layers.3.2.conv2.conv.weight', 'backbone._orig_mod.down_layers.3.3.norm1.weight', 'backbone._orig_mod.down_layers.2.1.norm1.weight', 'up_layers.0.0.norm2.weight', 'backbone._orig_mod.down_layers.1.1.norm2.bias', 'backbone._orig_mod.down_layers.1.0.conv.weight', 'backbone._orig_mod.down_layers.3.4.norm1.bias', 'down_layers.3.1.norm1.weight'}
[2025-05-16 05:10:13,939] [1] [MainThread] [WARNING] (monailabel.tasks.infer.basic_infer:475) - The run will now continue unless load_strict is set to True. If loading fails or the network behaves abnormally, please check the loaded weights
[2025-05-16 05:18:39,095] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:18:39,434] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:18:39,890] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:18:39,890] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:18:39,891] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:18:39,892] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:18:39,913] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:18:39,914] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:18:40,066] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f1201f60610>
[2025-05-16 05:18:40,077] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:18:40,078] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:18:40,079] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f120016a560>
[2025-05-16 05:18:40,079] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:18:40,086] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f1201f60610>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f1201f60190>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f1201f606d0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f1200158820>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f12012630d0>}
[2025-05-16 05:18:40,151] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f120155c430>
[2025-05-16 05:18:40,152] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:18:40,152] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:18:40,153] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 05:18:40,154] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:18:40,154] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f12001808b0>
[2025-05-16 05:18:40,155] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:18:50,750] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 05:18:50,752] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 15; Weight: 1747372730
[2025-05-16 05:18:50,859] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '15', 'weight': 1747372730, 'path': '/data/15.nii.gz', 'ts': 1747365741, 'name': '15.nii.gz'}
[2025-05-16 05:19:00,238] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '15', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 05:19:00,239] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/15.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 05:19:00,256] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 05:19:00,257] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 05:19:01,185] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.9275; image: torch.Size([512, 512, 89])(torch.float32)
[2025-05-16 05:19:01,187] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0014; image: torch.Size([1, 512, 512, 89])(torch.float32)
[2025-05-16 05:19:01,208] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0201; image: torch.Size([1, 512, 512, 89])(torch.float32)
[2025-05-16 05:19:01,305] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0962; image: torch.Size([1, 512, 512, 89])(torch.float32)
[2025-05-16 05:19:02,558] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.2534; image: torch.Size([1, 255, 255, 294])(torch.float32)
[2025-05-16 05:19:02,559] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 255, 255, 294])(torch.float32)
[2025-05-16 05:19:02,561] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 05:19:02,561] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:20:02,352] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-16 05:20:02,353] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:20:02,551] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.1969; image: torch.Size([3, 512, 512, 89])(torch.float32); pred: torch.Size([3, 255, 255, 294])(torch.float32)
[2025-05-16 05:20:02,554] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0028; image: torch.Size([3, 512, 512, 89])(torch.float32); pred: torch.Size([3, 255, 255, 294])(torch.float32)
[2025-05-16 05:20:02,556] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-16 05:20:02,556] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:20:02,557] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 255, 255, 294])(torch.float32); pred: torch.Size([3, 512, 512, 89])(torch.float32)
[2025-05-16 05:20:02,573] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0158; image: torch.Size([1, 255, 255, 294])(torch.float32); pred: torch.Size([3, 512, 512, 89])(torch.float32)
[2025-05-16 05:20:02,580] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0068; image: torch.Size([1, 255, 255, 294])(torch.float32); pred: torch.Size([1, 512, 512, 89])(torch.float32)
[2025-05-16 05:20:02,581] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0003; image: torch.Size([1, 255, 255, 294])(torch.float32); pred: torch.Size([512, 512, 89])(torch.float32)
[2025-05-16 05:20:02,581] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-16 05:20:02,582] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-16 05:20:05,676] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 65.4374; Pre: 2.3205; Inferer: 59.7588; Invert: 0.2364; Post: 0.0265; Write: 3.0944
[2025-05-16 05:20:05,676] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpte0r_xpv.nrrd
[2025-05-16 05:20:05,677] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-16 05:20:37,803] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:101) - Saving Label for 15 for tag: final by admin
[2025-05-16 05:20:37,803] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info": [{"name": "tumor", "idx": 2}, {"name": "metastasis", "idx": 3}], "client_id": "user-xyz"}
[2025-05-16 05:20:37,804] [1] [MainThread] [INFO] (monailabel.datastore.local:486) - Saving Label for Image: 15; Tag: final; Info: {'label_info': [{'name': 'tumor', 'idx': 2}, {'name': 'metastasis', 'idx': 3}], 'client_id': 'user-xyz'}
[2025-05-16 05:20:37,805] [1] [MainThread] [INFO] (monailabel.datastore.local:494) - Adding Label: 15 => final => /tmp/tmpogljlcen.nii.gz
[2025-05-16 05:20:37,809] [1] [MainThread] [INFO] (monailabel.datastore.local:510) - Label Info: {'label_info': [{'name': 'tumor', 'idx': 2}, {'name': 'metastasis', 'idx': 3}], 'client_id': 'user-xyz', 'ts': 1747372837, 'name': '15.nii.gz'}
[2025-05-16 05:20:37,813] [1] [MainThread] [INFO] (monailabel.interfaces.app:493) - New label saved for: 15 => 15
[2025-05-16 05:20:38,690] [1] [Thread-2] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
nal => 15 => 15.nii.gz
[2025-05-16 05:20:37,932] [1] [Thread-2] [INFO] (monailabel.datastore.local:577) - Invalidate count: 1
[2025-05-16 05:28:15,569] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:28:15,905] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:28:16,333] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:28:16,333] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:28:16,334] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:28:16,335] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:28:16,358] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:28:16,358] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:28:16,538] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f21d91b45e0>
[2025-05-16 05:28:16,545] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:28:16,546] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:28:16,548] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f21d83f6560>
[2025-05-16 05:28:16,550] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:28:16,556] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f21d91b45e0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f21d91b4160>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f21d91b46a0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f21d83dc880>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f21d84eb0a0>}
[2025-05-16 05:28:16,623] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f21d87d8400>
[2025-05-16 05:28:16,623] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:28:16,625] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:28:16,628] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 05:28:16,631] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:28:16,633] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f21d84088b0>
[2025-05-16 05:28:16,636] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:28:47,212] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 05:28:47,215] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 42; Weight: 1747373327
[2025-05-16 05:28:47,220] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '42', 'weight': 1747373327, 'path': '/data/42.nii.gz', 'ts': 1747365741, 'name': '42.nii.gz'}
[2025-05-16 05:29:08,151] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '42', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 05:29:08,152] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/42.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 05:29:08,172] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 05:29:08,172] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 05:29:09,502] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.3288; image: torch.Size([512, 512, 127])(torch.float32)
[2025-05-16 05:29:09,504] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0011; image: torch.Size([1, 512, 512, 127])(torch.float32)
[2025-05-16 05:29:09,528] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0243; image: torch.Size([1, 512, 512, 127])(torch.float32)
[2025-05-16 05:29:09,641] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.1126; image: torch.Size([1, 512, 512, 127])(torch.float32)
[2025-05-16 05:29:12,629] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 2.9874; image: torch.Size([1, 334, 334, 421])(torch.float32)
[2025-05-16 05:29:12,630] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 334, 334, 421])(torch.float32)
[2025-05-16 05:29:12,632] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 05:29:12,632] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:30:41,133] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-16 05:30:41,134] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:30:41,339] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.2035; image: torch.Size([3, 512, 512, 127])(torch.float32); pred: torch.Size([3, 334, 334, 421])(torch.float32)
[2025-05-16 05:30:41,342] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0028; image: torch.Size([3, 512, 512, 127])(torch.float32); pred: torch.Size([3, 334, 334, 421])(torch.float32)
[2025-05-16 05:30:41,344] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-16 05:30:41,344] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:30:41,345] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 334, 334, 421])(torch.float32); pred: torch.Size([3, 512, 512, 127])(torch.float32)
[2025-05-16 05:30:41,361] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0152; image: torch.Size([1, 334, 334, 421])(torch.float32); pred: torch.Size([3, 512, 512, 127])(torch.float32)
[2025-05-16 05:30:41,367] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0067; image: torch.Size([1, 334, 334, 421])(torch.float32); pred: torch.Size([1, 512, 512, 127])(torch.float32)
[2025-05-16 05:30:41,368] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0003; image: torch.Size([1, 334, 334, 421])(torch.float32); pred: torch.Size([512, 512, 127])(torch.float32)
[2025-05-16 05:30:41,368] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-16 05:30:41,369] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-16 05:30:44,578] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 96.4267; Pre: 4.4782; Inferer: 88.4444; Invert: 0.2676; Post: 0.0259; Write: 3.2096
[2025-05-16 05:30:44,578] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmp3gy8gmot.nrrd
[2025-05-16 05:30:44,579] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-16 05:34:20,821] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:101) - Saving Label for 42 for tag: final by admin
[2025-05-16 05:34:20,822] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info": [{"name": "tumor", "idx": 2}, {"name": "metastasis", "idx": 3}], "client_id": "user-xyz"}
[2025-05-16 05:34:20,822] [1] [MainThread] [INFO] (monailabel.datastore.local:486) - Saving Label for Image: 42; Tag: final; Info: {'label_info': [{'name': 'tumor', 'idx': 2}, {'name': 'metastasis', 'idx': 3}], 'client_id': 'user-xyz'}
[2025-05-16 05:34:20,823] [1] [MainThread] [INFO] (monailabel.datastore.local:494) - Adding Label: 42 => final => /tmp/tmp0zyizcec.nii.gz
[2025-05-16 05:34:20,827] [1] [MainThread] [INFO] (monailabel.datastore.local:510) - Label Info: {'label_info': [{'name': 'tumor', 'idx': 2}, {'name': 'metastasis', 'idx': 3}], 'client_id': 'user-xyz', 'ts': 1747373660, 'name': '42.nii.gz'}
[2025-05-16 05:34:20,934] [1] [MainThread] [INFO] (monailabel.interfaces.app:493) - New label saved for: 42 => 42
[2025-05-16 05:34:21,009] [1] [Thread-2] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:34:33,126] [1] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'pinkcc_ct_segresnet', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'user-xyz'}
[2025-05-16 05:34:33,127] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /usr::/apps/radiology
[2025-05-16 05:34:33,128] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /usr::/apps/radiology
[2025-05-16 05:34:33,129] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /usr/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"pinkcc_ct_segresnet","name":"train_01","pretrained":true,"device":"Tesla P100-PCIE-16GB:0","max_epochs":100,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":"SmartCacheDataset","dataloader":"ThreadDataLoader","tracking":"mlflow","tracking_uri":"","tracking_experiment_name":"","client_id":"user-xyz"}
[2025-05-16 05:34:33,585] [93] [MainThread] [INFO] (__main__:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:34:40,673] [93] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:34:40,878] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:34:40,878] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:34:40,878] [93] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:34:40,879] [93] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: False; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:34:40,894] [93] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:34:41,066] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fafa1ce7370>
Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
[2025-05-16 05:34:41,073] [93] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:34:41,073] [timeloop] [INFO] Starting Timeloop..
[2025-05-16 05:34:41,073] [93] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:34:41,073] [timeloop] [INFO] Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fafa0d4de10>
[2025-05-16 05:34:41,073] [93] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fafa0d4de10>
[2025-05-16 05:34:41,074] [timeloop] [INFO] Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:34:41,074] [93] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
[2025-05-16 05:34:41,078] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fafa1ce7370>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fafa1ce6ef0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fafa1ce7430>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fafa128f220>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fafa0f8bdc0>}
[2025-05-16 05:34:41,146] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fafa0cae290>
[2025-05-16 05:34:41,146] [93] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:34:41,146] [93] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:34:41,146] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:436) - Train Request (input): {'model': 'pinkcc_ct_segresnet', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'user-xyz', 'local_rank': 0}
[2025-05-16 05:34:41,147] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:449) - CUDA_VISIBLE_DEVICES: None
[2025-05-16 05:34:41,147] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:459) - Distributed/Multi GPU Training = TRUE
[2025-05-16 05:34:41,147] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:465) - Total proces to spawn: 2
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
[2025-05-16 05:34:48.557][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 1
[2025-05-16 05:34:48.558][ INFO](monailabel.tasks.train.basic_train) - 1 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pinkcc_ct_segresnet', 'client_id': 'user-xyz', 'local_rank': 0, 'run_id': '20250516_053441'}
[2025-05-16 05:34:48.558][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 0
[2025-05-16 05:34:48.559][ INFO](monailabel.tasks.train.basic_train) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pinkcc_ct_segresnet', 'client_id': 'user-xyz', 'local_rank': 0, 'run_id': '20250516_053441'}
[2025-05-16 05:34:49.268][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:0 => Using GPU-0
[2025-05-16 05:34:49.268][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:1 => Using GPU-1
[2025-05-16 05:34:49.300][ INFO](monailabel.tasks.train.basic_train) - 0 - Using Device: cuda:0; IDX: 0
[2025-05-16 05:34:49.301][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pinkcc_ct_segresnet/train_01
[2025-05-16 05:34:49.301][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-16 05:34:49.301][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pinkcc_ct_segresnet/train_01/mlruns;
[2025-05-16 05:34:49.301][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pinkcc_ct_segresnet; Run Name: run_20250516_053441
[2025-05-16 05:34:49.302][ INFO](monailabel.tasks.train.basic_train) - Total Records for Training: 2
[2025-05-16 05:34:49.302][ INFO](monailabel.tasks.train.basic_train) - Total Records for Validation: 0
[2025-05-16 05:34:49.679][ INFO](monailabel.tasks.train.basic_train) - 1 - Using Device: cuda:1; IDX: 1
[2025-05-16 05:34:49.679][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pinkcc_ct_segresnet/train_01
[2025-05-16 05:34:49.679][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-16 05:34:49.679][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pinkcc_ct_segresnet/train_01/mlruns;
[2025-05-16 05:34:49.679][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pinkcc_ct_segresnet; Run Name: run_20250516_053441
[2025-05-16 05:34:49.940][ INFO](monailabel.tasks.train.basic_train) - 0 - Load Path /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:34:49.950][ INFO](monailabel.tasks.train.basic_train) - 1 - Load Path /apps/radiology/model/pinkcc_segresnet.pt
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:06<00:00,  6.19s/it]
Loading dataset: 100%|██████████| 1/1 [00:06<00:00,  6.19s/it]
[2025-05-16 05:34:56.170][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Training: 1
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-16 05:34:56.182][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-16 05:34:56.278][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/pinkcc_segresnet.pt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
Loading dataset: 100%|██████████| 1/1 [00:12<00:00, 12.21s/it]
Loading dataset: 100%|██████████| 1/1 [00:12<00:00, 12.21s/it]
[2025-05-16 05:35:02.181][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Training: 1
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-16 05:35:02.197][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-16 05:35:02.350][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/pinkcc_segresnet.pt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
[2025-05-16 05:35:05.567][ERROR](ignite.engine.engine.SupervisedTrainer) - Current run is terminating due to exception: applying transform <monai.transforms.compose.Compose object at 0x7f050cb53f40>
[2025-05-16 05:35:05.572][ERROR](ignite.engine.engine.SupervisedTrainer) - Current run is terminating due to exception: applying transform <monai.transforms.compose.Compose object at 0x7f4870c64e20>
[2025-05-16 05:35:05.572][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception: applying transform <monai.transforms.compose.Compose object at 0x7f4870c64e20>
2025-05-16 05:35:05,567 - ERROR - Exception: applying transform <monai.transforms.compose.Compose object at 0x7f050cb53f40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/post/dictionary.py", line 209, in __call__
    d[key] = self.converter(d[key], argmax, to_onehot, threshold, rounding)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/post/array.py", line 222, in __call__
    img_t = one_hot(
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/utils.py", line 211, in one_hot
    raise AssertionError("labels should have a channel with length equal to one.")
AssertionError: labels should have a channel with length equal to one.
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 335, in __call__
    result = execute_compose(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 111, in execute_compose
    data = apply_transform(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 171, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.post.dictionary.AsDiscreted object at 0x7f050cc95240>
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 281, in _iteration
    engine.fire_event(IterationEvents.MODEL_COMPLETED)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 449, in fire_event
    return self._fire_event(event_name)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 225, in _run_postprocessing
    engine.state.batch[i], engine.state.output[i] = engine_apply_transform(b, o, posttrans)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/utils.py", line 335, in engine_apply_transform
    transformed_data = apply_transform(transform, data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 171, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x7f050cb53f40>
[2025-05-16 05:35:05.574][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception: applying transform <monai.transforms.compose.Compose object at 0x7f050cb53f40>
2025-05-16 05:35:05,574 - ERROR - Exception: applying transform <monai.transforms.compose.Compose object at 0x7f050cb53f40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/post/dictionary.py", line 209, in __call__
    d[key] = self.converter(d[key], argmax, to_onehot, threshold, rounding)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/post/array.py", line 222, in __call__
    img_t = one_hot(
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/utils.py", line 211, in one_hot
    raise AssertionError("labels should have a channel with length equal to one.")
AssertionError: labels should have a channel with length equal to one.
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 335, in __call__
    result = execute_compose(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 111, in execute_compose
    data = apply_transform(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 171, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.post.dictionary.AsDiscreted object at 0x7f050cc95240>
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1087, in _run_once_on_dataset_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/stats_handler.py", line 201, in exception_raised
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 281, in _iteration
    engine.fire_event(IterationEvents.MODEL_COMPLETED)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 449, in fire_event
    return self._fire_event(event_name)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 225, in _run_postprocessing
    engine.state.batch[i], engine.state.output[i] = engine_apply_transform(b, o, posttrans)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/utils.py", line 335, in engine_apply_transform
    transformed_data = apply_transform(transform, data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 171, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x7f050cb53f40>
[rank1]:[W516 05:35:05.771956435 CUDAGuardImpl.h:119] Warning: CUDA warning: device-side assert triggered (function destroyEvent)
terminate called after throwing an instance of 'c10::Error'
[rank0]:[W516 05:35:05.773465218 CUDAGuardImpl.h:119] Warning: CUDA warning: device-side assert triggered (function destroyEvent)
terminate called after throwing an instance of 'c10::Error'
  what():  CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
Exception raised from c10_cuda_check_implementation at ../c10/cuda/CUDAException.cpp:43 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f066e76c446 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) + 0x64 (0x7f066e7166e4 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #2: c10::cuda::c10_cuda_check_implementation(int, char const*, char const*, int, bool) + 0x118 (0x7f066eba9a18 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1f92e (0x7f066eb7092e in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #4: <unknown function> + 0x20a57 (0x7f066eb71a57 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #5: <unknown function> + 0x20c5f (0x7f066eb71c5f in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #6: <unknown function> + 0x5faf70 (0x7f066d59af70 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x6f69f (0x7f066e74d69f in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #8: c10::TensorImpl::~TensorImpl() + 0x21b (0x7f066e74637b in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #9: c10::TensorImpl::~TensorImpl() + 0x9 (0x7f066e746529 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #10: c10d::Reducer::~Reducer() + 0x5c4 (0x7f065e380eb4 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_cpu.so)
frame #11: std::_Sp_counted_ptr<c10d::Reducer*, (__gnu_cxx::_Lock_policy)2>::_M_dispose() + 0x12 (0x7f066dd42bf2 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #12: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() + 0x48 (0x7f066d45e078 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #13: <unknown function> + 0xdadc21 (0x7f066dd4dc21 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #14: <unknown function> + 0x4c90f3 (0x7f066d4690f3 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #15: <unknown function> + 0x4c9c71 (0x7f066d469c71 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #16: <unknown function> + 0x169be3 (0x55df79b45be3 in /usr/bin/python)
frame #17: <unknown function> + 0x20e4c1 (0x55df79bea4c1 in /usr/bin/python)
frame #18: <unknown function> + 0x15d51d (0x55df79b3951d in /usr/bin/python)
frame #19: <unknown function> + 0x257110 (0x55df79c33110 in /usr/bin/python)
frame #20: PyGC_Collect + 0x6e (0x55df79c5fdce in /usr/bin/python)
frame #21: Py_FinalizeEx + 0x140 (0x55df79c5de50 in /usr/bin/python)
frame #22: Py_Exit + 0xc (0x55df79c703ac in /usr/bin/python)
frame #23: <unknown function> + 0x283e8f (0x55df79c5fe8f in /usr/bin/python)
frame #24: PyErr_PrintEx + 0x1d (0x55df79c5fc3d in /usr/bin/python)
frame #25: PyRun_SimpleStringFlags + 0x72 (0x55df79c51e42 in /usr/bin/python)
frame #26: Py_RunMain + 0x3d0 (0x55df79c51140 in /usr/bin/python)
frame #27: Py_BytesMain + 0x2d (0x55df79c2ad6d in /usr/bin/python)
frame #28: <unknown function> + 0x29d90 (0x7f066ff37d90 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #29: __libc_start_main + 0x80 (0x7f066ff37e40 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #30: _start + 0x25 (0x55df79c2ac65 in /usr/bin/python)
  what():  CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
Exception raised from c10_cuda_check_implementation at ../c10/cuda/CUDAException.cpp:43 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x7f49863ca446 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::string const&) + 0x64 (0x7f49863746e4 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #2: c10::cuda::c10_cuda_check_implementation(int, char const*, char const*, int, bool) + 0x118 (0x7f49d1773a18 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #3: <unknown function> + 0x1f92e (0x7f49d173a92e in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #4: <unknown function> + 0x20a57 (0x7f49d173ba57 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #5: <unknown function> + 0x20c5f (0x7f49d173bc5f in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10_cuda.so)
frame #6: <unknown function> + 0x5faf70 (0x7f49d059af70 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x6f69f (0x7f49863ab69f in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #8: c10::TensorImpl::~TensorImpl() + 0x21b (0x7f49863a437b in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #9: c10::TensorImpl::~TensorImpl() + 0x9 (0x7f49863a4529 in /usr/local/lib/python3.10/dist-packages/torch/lib/libc10.so)
frame #10: c10d::Reducer::~Reducer() + 0x5c4 (0x7f49c1380eb4 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_cpu.so)
frame #11: std::_Sp_counted_ptr<c10d::Reducer*, (__gnu_cxx::_Lock_policy)2>::_M_dispose() + 0x12 (0x7f49d0d42bf2 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #12: std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() + 0x48 (0x7f49d045e078 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #13: <unknown function> + 0xdadc21 (0x7f49d0d4dc21 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #14: <unknown function> + 0x4c90f3 (0x7f49d04690f3 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #15: <unknown function> + 0x4c9c71 (0x7f49d0469c71 in /usr/local/lib/python3.10/dist-packages/torch/lib/libtorch_python.so)
frame #16: <unknown function> + 0x169be3 (0x56151ae38be3 in /usr/bin/python)
frame #17: <unknown function> + 0x20e4c1 (0x56151aedd4c1 in /usr/bin/python)
frame #18: <unknown function> + 0x15d51d (0x56151ae2c51d in /usr/bin/python)
frame #19: <unknown function> + 0x257110 (0x56151af26110 in /usr/bin/python)
frame #20: PyGC_Collect + 0x6e (0x56151af52dce in /usr/bin/python)
frame #21: Py_FinalizeEx + 0x140 (0x56151af50e50 in /usr/bin/python)
frame #22: Py_Exit + 0xc (0x56151af633ac in /usr/bin/python)
frame #23: <unknown function> + 0x283e8f (0x56151af52e8f in /usr/bin/python)
frame #24: PyErr_PrintEx + 0x1d (0x56151af52c3d in /usr/bin/python)
frame #25: PyRun_SimpleStringFlags + 0x72 (0x56151af44e42 in /usr/bin/python)
frame #26: Py_RunMain + 0x3d0 (0x56151af44140 in /usr/bin/python)
frame #27: Py_BytesMain + 0x2d (0x56151af1dd6d in /usr/bin/python)
frame #28: <unknown function> + 0x29d90 (0x7f49d2db3d90 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #29: __libc_start_main + 0x80 (0x7f49d2db3e40 in /usr/lib/x86_64-linux-gnu/libc.so.6)
frame #30: _start + 0x25 (0x56151af1dc65 in /usr/bin/python)
W0516 05:35:06.194000 93 local/lib/python3.10/dist-packages/torch/multiprocessing/spawn.py:160] Terminating process 167 via signal SIGTERM
-------------------------------------------------------------------------------
runpy.py 196 _run_module_as_main
return _run_code(code, main_globals, None,
runpy.py 86 _run_code
exec(code, run_globals)
app.py 128 <module>
run_main()
app.py 113 run_main
result = a.train(request)
app.py 423 train
result = task(request, self.datastore())
basic_train.py 466 __call__
torch.multiprocessing.spawn(main_worker, nprocs=world_size, args=(world_size, req, datalist, self))
spawn.py 328 spawn
return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
spawn.py 284 start_processes
while not context.join():
spawn.py 203 join
raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException:
-- Process 1 terminated with the following error:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/post/dictionary.py", line 209, in __call__
    d[key] = self.converter(d[key], argmax, to_onehot, threshold, rounding)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/post/array.py", line 222, in __call__
    img_t = one_hot(
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/utils.py", line 211, in one_hot
    raise AssertionError("labels should have a channel with length equal to one.")
AssertionError: labels should have a channel with length equal to one.
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 141, in apply_transform
    return _apply_transform(transform, data, unpack_items, lazy, overrides, log_stats)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 98, in _apply_transform
    return transform(data, lazy=lazy) if isinstance(transform, LazyTrait) else transform(data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 335, in __call__
    result = execute_compose(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/compose.py", line 111, in execute_compose
    data = apply_transform(
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 171, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.post.dictionary.AsDiscreted object at 0x7f486f9e1de0>
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/torch/multiprocessing/spawn.py", line 90, in _wrap
    fn(i, *args)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 735, in main_worker
    task.train(rank, world_size, request, datalist)
  File "/usr/local/lib/python3.10/dist-packages/monailabel/tasks/train/basic_train.py", line 559, in train
    context.trainer.run()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 55, in run
    super().run()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 282, in run
    super().run(data=self.data_loader, max_epochs=self.state.max_epochs)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 892, in run
    return self._internal_run()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 935, in _internal_run
    return next(self._internal_run_generator)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 993, in _internal_run_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 638, in _handle_exception
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1087, in _run_once_on_dataset_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 638, in _handle_exception
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/trainer.py", line 281, in _iteration
    engine.fire_event(IterationEvents.MODEL_COMPLETED)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 449, in fire_event
    return self._fire_event(event_name)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 225, in _run_postprocessing
    engine.state.batch[i], engine.state.output[i] = engine_apply_transform(b, o, posttrans)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/utils.py", line 335, in engine_apply_transform
    transformed_data = apply_transform(transform, data)
  File "/usr/local/lib/python3.10/dist-packages/monai/transforms/transform.py", line 171, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.compose.Compose object at 0x7f4870c64e20>
[2025-05-16 05:35:07,425] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: 1
[2025-05-16 05:42:09,394] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:42:09,732] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:42:10,210] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:42:10,211] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:42:10,211] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:42:10,212] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:42:10,226] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:42:10,226] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:42:10,390] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f5342bc02e0>
[2025-05-16 05:42:10,399] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:42:10,400] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:42:10,400] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f5340bb2560>
[2025-05-16 05:42:10,401] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:42:10,407] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f5342bc02e0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f5342b7b760>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f5354b9b460>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f5340b894b0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f5341ca2ce0>}
[2025-05-16 05:42:10,473] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f534214bfd0>
[2025-05-16 05:42:10,473] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:42:10,474] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:42:10,474] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 05:42:10,475] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:42:10,475] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f5340bc08b0>
[2025-05-16 05:42:10,476] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:42:17,138] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 05:42:17,141] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 33; Weight: 1747374137
[2025-05-16 05:42:17,146] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '33', 'weight': 1747374137, 'path': '/data/33.nii.gz', 'ts': 1747365741, 'name': '33.nii.gz'}
[2025-05-16 05:42:41,250] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '33', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 05:42:41,251] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/33.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 05:42:41,269] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 05:42:41,269] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 05:42:42,267] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.996; image: torch.Size([512, 512, 95])(torch.float32)
[2025-05-16 05:42:42,268] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0012; image: torch.Size([1, 512, 512, 95])(torch.float32)
[2025-05-16 05:42:42,291] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.022; image: torch.Size([1, 512, 512, 95])(torch.float32)
[2025-05-16 05:42:42,389] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0979; image: torch.Size([1, 512, 512, 95])(torch.float32)
[2025-05-16 05:42:43,778] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.3883; image: torch.Size([1, 258, 258, 314])(torch.float32)
[2025-05-16 05:42:43,778] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 258, 258, 314])(torch.float32)
[2025-05-16 05:42:43,780] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 05:42:43,781] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:43:18,445] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-16 05:43:18,446] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:43:18,643] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.1952; image: torch.Size([3, 512, 512, 95])(torch.float32); pred: torch.Size([3, 258, 258, 314])(torch.float32)
[2025-05-16 05:43:18,646] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0025; image: torch.Size([3, 512, 512, 95])(torch.float32); pred: torch.Size([3, 258, 258, 314])(torch.float32)
[2025-05-16 05:43:18,647] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-16 05:43:18,647] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:43:18,648] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 258, 258, 314])(torch.float32); pred: torch.Size([3, 512, 512, 95])(torch.float32)
[2025-05-16 05:43:18,664] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0152; image: torch.Size([1, 258, 258, 314])(torch.float32); pred: torch.Size([3, 512, 512, 95])(torch.float32)
[2025-05-16 05:43:18,671] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0066; image: torch.Size([1, 258, 258, 314])(torch.float32); pred: torch.Size([1, 512, 512, 95])(torch.float32)
[2025-05-16 05:43:18,671] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 258, 258, 314])(torch.float32); pred: torch.Size([512, 512, 95])(torch.float32)
[2025-05-16 05:43:18,672] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-16 05:43:18,673] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-16 05:43:21,778] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 40.5268; Pre: 2.5274; Inferer: 34.6390; Invert: 0.2280; Post: 0.0258; Write: 3.1059
[2025-05-16 05:43:21,778] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpm08zl4_p.nrrd
[2025-05-16 05:43:21,779] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-16 05:44:11,443] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:101) - Saving Label for 33 for tag: final by admin
[2025-05-16 05:44:11,444] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info": [{"name": "tumor", "idx": 2}, {"name": "metastasis", "idx": 3}], "client_id": "user-xyz"}
[2025-05-16 05:44:11,444] [1] [MainThread] [INFO] (monailabel.datastore.local:486) - Saving Label for Image: 33; Tag: final; Info: {'label_info': [{'name': 'tumor', 'idx': 2}, {'name': 'metastasis', 'idx': 3}], 'client_id': 'user-xyz'}
[2025-05-16 05:44:11,445] [1] [MainThread] [INFO] (monailabel.datastore.local:494) - Adding Label: 33 => final => /tmp/tmpagp9a_p8.nii.gz
[2025-05-16 05:44:11,449] [1] [MainThread] [INFO] (monailabel.datastore.local:510) - Label Info: {'label_info': [{'name': 'tumor', 'idx': 2}, {'name': 'metastasis', 'idx': 3}], 'client_id': 'user-xyz', 'ts': 1747374251, 'name': '33.nii.gz'}
[2025-05-16 05:44:11,555] [1] [MainThread] [INFO] (monailabel.interfaces.app:493) - New label saved for: 33 => 33
[2025-05-16 05:44:11,654] [1] [Thread-2] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
                       [2025-05-16 05:44:22,045] [1] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'pinkcc_ct_segresnet', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'user-xyz'}
[2025-05-16 05:44:22,046] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /usr::/apps/radiology
[2025-05-16 05:44:22,047] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /usr::/apps/radiology
[2025-05-16 05:44:22,048] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /usr/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"pinkcc_ct_segresnet","name":"train_01","pretrained":true,"device":"Tesla P100-PCIE-16GB:0","max_epochs":100,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":"SmartCacheDataset","dataloader":"ThreadDataLoader","tracking":"mlflow","tracking_uri":"","tracking_experiment_name":"","client_id":"user-xyz"}
[2025-05-16 05:44:22,501] [93] [MainThread] [INFO] (__main__:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml'}
[2025-05-16 05:44:29,471] [93] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:44:29,681] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:44:29,681] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pinkcc_ct_segresnet']
[2025-05-16 05:44:29,681] [93] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:44:29,681] [93] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: False; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:44:29,697] [93] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:44:29,826] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f5be3802f20>
Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
[2025-05-16 05:44:29,832] [93] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:44:29,833] [timeloop] [INFO] Starting Timeloop..
[2025-05-16 05:44:29,833] [93] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:44:29,833] [timeloop] [INFO] Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f5be28a5e10>
[2025-05-16 05:44:29,833] [93] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f5be28a5e10>
[2025-05-16 05:44:29,833] [timeloop] [INFO] Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:44:29,833] [93] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
[2025-05-16 05:44:29,838] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f5be3802f20>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f5be3802aa0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f5be3802fe0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f5be27fe740>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f5be28fbcd0>}
[2025-05-16 05:44:29,902] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f5be2be2dd0>
[2025-05-16 05:44:29,903] [93] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:44:29,903] [93] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:44:29,903] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:436) - Train Request (input): {'model': 'pinkcc_ct_segresnet', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'user-xyz', 'local_rank': 0}
[2025-05-16 05:44:29,903] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:449) - CUDA_VISIBLE_DEVICES: None
[2025-05-16 05:44:29,903] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:459) - Distributed/Multi GPU Training = TRUE
[2025-05-16 05:44:29,904] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:465) - Total proces to spawn: 2
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
[2025-05-16 05:44:37.307][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 0
[2025-05-16 05:44:37.307][ INFO](monailabel.tasks.train.basic_train) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pinkcc_ct_segresnet', 'client_id': 'user-xyz', 'local_rank': 0, 'run_id': '20250516_054429'}
[2025-05-16 05:44:37.437][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 1
[2025-05-16 05:44:37.438][ INFO](monailabel.tasks.train.basic_train) - 1 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pinkcc_ct_segresnet', 'client_id': 'user-xyz', 'local_rank': 0, 'run_id': '20250516_054429'}
[2025-05-16 05:44:37.507][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:0 => Using GPU-0
[2025-05-16 05:44:37.507][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:1 => Using GPU-1
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - 0 - Using Device: cuda:0; IDX: 0
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pinkcc_ct_segresnet/train_01
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pinkcc_ct_segresnet/train_01/mlruns;
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pinkcc_ct_segresnet; Run Name: run_20250516_054429
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - Total Records for Training: 2
[2025-05-16 05:44:37.539][ INFO](monailabel.tasks.train.basic_train) - Total Records for Validation: 1
[2025-05-16 05:44:37.908][ INFO](monailabel.tasks.train.basic_train) - 1 - Using Device: cuda:1; IDX: 1
[2025-05-16 05:44:37.908][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pinkcc_ct_segresnet/train_01
[2025-05-16 05:44:37.908][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-16 05:44:37.908][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pinkcc_ct_segresnet/train_01/mlruns;
[2025-05-16 05:44:37.908][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pinkcc_ct_segresnet; Run Name: run_20250516_054429
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 16070.13it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 3880.02it/s]
[2025-05-16 05:44:38.674][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Validation: 1
[2025-05-16 05:44:38.675][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Validation: 1
[2025-05-16 05:44:38.680][ INFO](monailabel.tasks.train.basic_train) - 1 - Adding Validation to run every '1' interval
[2025-05-16 05:44:38.680][ INFO](monailabel.tasks.train.basic_train) - 1 - Load Path /apps/radiology/model/pinkcc_segresnet.pt
[2025-05-16 05:44:38.684][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7f900056dc60> to <monai.transforms.compose.Compose object at 0x7f8f99466200>
[2025-05-16 05:44:38.685][ INFO](monailabel.tasks.train.basic_train) - 0 - Adding Validation to run every '1' interval
[2025-05-16 05:44:38.685][ INFO](monailabel.tasks.train.basic_train) - 0 - Load Path /apps/radiology/model/pinkcc_segresnet.pt
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s][2025-05-16 05:44:38.690][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7f521960a860> to <monai.transforms.compose.Compose object at 0x7f52186a2410>
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:07<00:00,  7.41s/it]
Loading dataset: 100%|██████████| 1/1 [00:07<00:00,  7.41s/it]
[2025-05-16 05:44:46.095][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Training: 1
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-16 05:44:46.108][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-16 05:44:46.200][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/pinkcc_segresnet.pt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
Loading dataset: 100%|██████████| 1/1 [00:12<00:00, 12.12s/it]
Loading dataset: 100%|██████████| 1/1 [00:12<00:00, 12.12s/it]
[2025-05-16 05:44:50.818][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Training: 1
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-16 05:44:50.834][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-16 05:44:50.983][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/pinkcc_segresnet.pt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
2025-05-16 05:44:54,374 - INFO - Epoch: 1/100, Iter: 1/1 -- train_loss: 0.4086
[2025-05-16 05:44:54.456][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.9467245936393738
[2025-05-16 05:44:54.456][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 2.622518262958235e-05
[2025-05-16 05:44:54.456][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 0 until 1 epochs
[2025-05-16 05:44:54.459][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.9467245936393738
[2025-05-16 05:44:54.459][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 2.622518262958235e-05
2025-05-16 05:44:54,459 - INFO - Epoch[1] Metrics -- train_mean_dice: 0.9467
2025-05-16 05:44:54,459 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:44:54.463][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 0 until 1 epochs
[2025-05-16 05:45:29.437][ INFO](ignite.engine.engine.SupervisedEvaluator) - Got new best metric of val_mean_dice: 0.9398839473724365
[2025-05-16 05:45:29.437][ INFO](ignite.engine.engine.SupervisedEvaluator) - Got new best metric of val_mean_dice: 0.9398839473724365
2025-05-16 05:45:29,437 - INFO - Epoch[1] Metrics -- val_mean_dice: 0.9399
[2025-05-16 05:45:29.437][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[1] Complete. Time taken: 00:00:34.981
2025-05-16 05:45:29,437 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:45:29.437][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.981
[2025-05-16 05:45:29.438][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[1] Complete. Time taken: 00:00:43.236
[2025-05-16 05:45:29.791][ INFO](monailabel.tasks.train.handler) - New Model published: /apps/radiology/model/pinkcc_ct_segresnet/train_01/best_model.ckpt => /apps/radiology/model/pinkcc_ct_segresnet.ckpt
[2025-05-16 05:45:29.791][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[1] Complete. Time taken: 00:00:35.302
[2025-05-16 05:45:29.796][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.333
[2025-05-16 05:45:29.984][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[1] Complete. Time taken: 00:00:39.000
2025-05-16 05:45:32,738 - INFO - Epoch: 2/100, Iter: 1/1 -- train_loss: 0.3921
[2025-05-16 05:45:32.773][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 5.24503652591647e-05
[2025-05-16 05:45:32.773][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 1 until 2 epochs
[2025-05-16 05:45:32.773][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 5.24503652591647e-05
2025-05-16 05:45:32,773 - INFO - Epoch[2] Metrics -- train_mean_dice: 0.7350
2025-05-16 05:45:32,773 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:45:32.777][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 1 until 2 epochs
[2025-05-16 05:46:07.873][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[2] Complete. Time taken: 00:00:35.100
2025-05-16 05:46:07,873 - INFO - Epoch[2] Metrics -- val_mean_dice: 0.9263
[2025-05-16 05:46:07.873][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.100
2025-05-16 05:46:07,873 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:46:07.874][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[2] Complete. Time taken: 00:00:38.436
[2025-05-16 05:46:08.048][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[2] Complete. Time taken: 00:00:35.226
[2025-05-16 05:46:08.052][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.274
[2025-05-16 05:46:08.052][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[2] Complete. Time taken: 00:00:38.068
2025-05-16 05:46:11,083 - INFO - Epoch: 3/100, Iter: 1/1 -- train_loss: 0.3843
[2025-05-16 05:46:11.130][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 7.867554788874704e-05
[2025-05-16 05:46:11.131][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 2 until 3 epochs
[2025-05-16 05:46:11.131][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 7.867554788874704e-05
2025-05-16 05:46:11,131 - INFO - Epoch[3] Metrics -- train_mean_dice: 0.5022
2025-05-16 05:46:11,131 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:46:11.135][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 2 until 3 epochs
[2025-05-16 05:46:45.930][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[3] Complete. Time taken: 00:00:34.799
[2025-05-16 05:46:45.930][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.800
[2025-05-16 05:46:45.931][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[3] Complete. Time taken: 00:00:38.057
2025-05-16 05:46:45,931 - INFO - Epoch[3] Metrics -- val_mean_dice: 0.9099
2025-05-16 05:46:45,932 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:46:46.319][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[3] Complete. Time taken: 00:00:35.135
[2025-05-16 05:46:46.460][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.325
[2025-05-16 05:46:46.460][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[3] Complete. Time taken: 00:00:38.408
2025-05-16 05:46:49,398 - INFO - Epoch: 4/100, Iter: 1/1 -- train_loss: 0.3988
[2025-05-16 05:46:49.511][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001049007305183294
2025-05-16 05:46:49,511 - INFO - Epoch[4] Metrics -- train_mean_dice: 0.6814
[2025-05-16 05:46:49.511][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001049007305183294
2025-05-16 05:46:49,511 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:46:49.512][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 3 until 4 epochs
[2025-05-16 05:46:49.580][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 3 until 4 epochs
[2025-05-16 05:47:25.364][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[4] Complete. Time taken: 00:00:35.852
[2025-05-16 05:47:25.364][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.853
2025-05-16 05:47:25,364 - INFO - Epoch[4] Metrics -- val_mean_dice: 0.8437
[2025-05-16 05:47:25.364][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[4] Complete. Time taken: 00:00:39.434
2025-05-16 05:47:25,364 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:47:25.374][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[4] Complete. Time taken: 00:00:34.578
[2025-05-16 05:47:25.378][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.799
[2025-05-16 05:47:25.379][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[4] Complete. Time taken: 00:00:38.918
2025-05-16 05:47:28,240 - INFO - Epoch: 5/100, Iter: 1/1 -- train_loss: 0.4019
[2025-05-16 05:47:28.249][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00013112591314791175
[2025-05-16 05:47:28.249][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 4 until 5 epochs
[2025-05-16 05:47:28.249][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00013112591314791175
2025-05-16 05:47:28,249 - INFO - Epoch[5] Metrics -- train_mean_dice: 0.7848
2025-05-16 05:47:28,249 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:47:28.253][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 4 until 5 epochs
[2025-05-16 05:48:03.094][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[5] Complete. Time taken: 00:00:34.845
2025-05-16 05:48:03,094 - INFO - Epoch[5] Metrics -- val_mean_dice: 0.7802
2025-05-16 05:48:03,095 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:48:03.095][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.845
[2025-05-16 05:48:03.095][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[5] Complete. Time taken: 00:00:37.730
[2025-05-16 05:48:03.104][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[5] Complete. Time taken: 00:00:34.727
[2025-05-16 05:48:03.108][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.854
[2025-05-16 05:48:03.108][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[5] Complete. Time taken: 00:00:37.729
2025-05-16 05:48:06,027 - INFO - Epoch: 6/100, Iter: 1/1 -- train_loss: 0.3997
[2025-05-16 05:48:06.036][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001573510957774941
2025-05-16 05:48:06,036 - INFO - Epoch[6] Metrics -- train_mean_dice: 0.7017
2025-05-16 05:48:06,036 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:48:06.037][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001573510957774941
[2025-05-16 05:48:06.037][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 5 until 6 epochs
[2025-05-16 05:48:06.041][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 5 until 6 epochs
2025-05-16 05:48:41,559 - INFO - Epoch[6] Metrics -- val_mean_dice: 0.7547
2025-05-16 05:48:41,559 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:48:41.559][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[6] Complete. Time taken: 00:00:35.522
[2025-05-16 05:48:41.560][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.523
[2025-05-16 05:48:41.560][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[6] Complete. Time taken: 00:00:38.465
[2025-05-16 05:48:41.568][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[6] Complete. Time taken: 00:00:35.399
[2025-05-16 05:48:41.572][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.532
[2025-05-16 05:48:41.573][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[6] Complete. Time taken: 00:00:38.464
2025-05-16 05:48:44,433 - INFO - Epoch: 7/100, Iter: 1/1 -- train_loss: 0.3951
[2025-05-16 05:48:44.442][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00018357627840707646
[2025-05-16 05:48:44.443][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00018357627840707646
[2025-05-16 05:48:44.443][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 6 until 7 epochs
2025-05-16 05:48:44,443 - INFO - Epoch[7] Metrics -- train_mean_dice: 0.5238
2025-05-16 05:48:44,443 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:48:44.447][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 6 until 7 epochs
[2025-05-16 05:49:19.375][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[7] Complete. Time taken: 00:00:34.932
[2025-05-16 05:49:19.375][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.932
[2025-05-16 05:49:19.375][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[7] Complete. Time taken: 00:00:37.815
2025-05-16 05:49:19,375 - INFO - Epoch[7] Metrics -- val_mean_dice: 0.7547
2025-05-16 05:49:19,376 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 05:49:19.385][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[7] Complete. Time taken: 00:00:34.802
[2025-05-16 05:49:19.389][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.942
[2025-05-16 05:49:19.389][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[7] Complete. Time taken: 00:00:37.816
2025-05-16 05:49:22,322 - INFO - Epoch: 8/100, Iter: 1/1 -- train_loss: 0.3962
[2025-05-16 05:49:22.330][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00020980146103665882
[2025-05-16 05:49:22.331][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00020980146103665882
[2025-05-16 05:49:22.331][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 7 until 8 epochs
2025-05-16 05:49:22,331 - INFO - Epoch[8] Metrics -- train_mean_dice: 0.3232
2025-05-16 05:49:22,331 - INFO - Key metric: train_mean_dice best value: 0.9467245936393738 at epoch: 1
[2025-05-16 05:49:22.335][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 7 until 8 epochs
-------------------------------------------------------------------------------
runpy.py 196 _run_module_as_main
return _run_code(code, main_globals, None,
runpy.py 86 _run_code
exec(code, run_globals)
app.py 128 <module>
run_main()
app.py 113 run_main
result = a.train(request)
app.py 423 train
result = task(request, self.datastore())
basic_train.py 466 __call__
[2025-05-16 05:49:38.592][ERROR](ignite.engine.engine.SupervisedEvaluator) - Engine run is terminating due to exception:
torch.multiprocessing.spawn(main_worker, nprocs=world_size, args=(world_size, req, datalist, self))
spawn.py 328 spawn
return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
spawn.py 284 start_processes
while not context.join():
spawn.py 132 join
ready = multiprocessing.connection.wait(
connection.py 931 wait
[2025-05-16 05:49:38.594][ERROR](ignite.engine.engine.SupervisedEvaluator) - Engine run is terminating due to exception:
ready = selector.select(timeout)
[2025-05-16 05:49:38.594][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception:
selectors.py 416 select
fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
2025-05-16 05:49:38,592 - ERROR - Exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/evaluator.py", line 334, in _iteration
    engine.state.output[Keys.PRED] = engine.inferer(inputs, engine.network, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/inferer.py", line 532, in __call__
    return sliding_window_inference(
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/utils.py", line 229, in sliding_window_inference
    seg_prob_out = predictor(win_data, *args, **kwargs)  # batched patch
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 180, in forward
    x, down_x = self.encode(x)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 164, in encode
    x = down(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/blocks/segresnet_block.py", line 87, in forward
    x = self.act(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
KeyboardInterrupt
[2025-05-16 05:49:38.598][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception:
2025-05-16 05:49:38,598 - ERROR - Exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 965, in _internal_run_as_gen
    self._fire_event(Events.EPOCH_COMPLETED)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/validation_handler.py", line 85, in __call__
    self.validator.run(engine.state.epoch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/evaluator.py", line 150, in run
    super().run()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 282, in run
    super().run(data=self.data_loader, max_epochs=self.state.max_epochs)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 892, in run
    return self._internal_run()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 935, in _internal_run
    return next(self._internal_run_generator)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 993, in _internal_run_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/stats_handler.py", line 201, in exception_raised
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/evaluator.py", line 334, in _iteration
    engine.state.output[Keys.PRED] = engine.inferer(inputs, engine.network, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/inferer.py", line 532, in __call__
    return sliding_window_inference(
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/utils.py", line 229, in sliding_window_inference
    seg_prob_out = predictor(win_data, *args, **kwargs)  # batched patch
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 180, in forward
    x, down_x = self.encode(x)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 164, in encode
    x = down(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/blocks/segresnet_block.py", line 87, in forward
    x = self.act(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/activation.py", line 133, in forward
    return F.relu(input, inplace=self.inplace)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 1702, in relu
    result = torch.relu_(input)
KeyboardInterrupt
[rank0]:[W516 05:49:39.313686726 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[2025-05-16 05:49:41,752] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: -2
[2025-05-16 05:50:09,170] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml'}
[2025-05-16 05:50:09,498] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:50:09,935] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:50:10,027] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:50:10,027] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext', 'pinkcc_ct_segresnet']
[2025-05-16 05:50:10,028] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:50:10,029] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:50:10,042] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:50:10,042] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:50:10,260] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe82897ff70>
[2025-05-16 05:50:10,325] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe82897ec20>
[2025-05-16 05:50:10,332] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:50:10,333] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:50:10,333] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fe8288ab490>
[2025-05-16 05:50:10,334] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:50:10,340] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe82897ff70>, 'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe82897ec20>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fe82897ffa0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fe82881c940>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fe82881ec80>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fe8288dad70>}
[2025-05-16 05:50:10,473] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fe828d7ff70>
[2025-05-16 05:50:10,538] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fe8288a3af0>
[2025-05-16 05:50:10,538] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:50:10,539] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:50:10,539] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 05:50:10,540] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:50:10,541] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fe8288b97e0>
[2025-05-16 05:50:10,541] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:51:30,100] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 05:51:30,103] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 48; Weight: 1747374690
[2025-05-16 05:51:30,108] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '48', 'weight': 1747374690, 'path': '/data/48.nii.gz', 'ts': 1747365741, 'name': '48.nii.gz'}
[2025-05-16 05:53:18,128] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '48', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 05:53:18,129] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/48.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 05:53:18,146] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 05:53:18,147] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 05:53:19,610] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.4622; image: torch.Size([512, 512, 130])(torch.float32)
[2025-05-16 05:53:19,611] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0006; image: torch.Size([1, 512, 512, 130])(torch.float32)
[2025-05-16 05:53:19,630] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0191; image: torch.Size([1, 512, 512, 130])(torch.float32)
[2025-05-16 05:53:19,753] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.1217; image: torch.Size([1, 512, 512, 130])(torch.float32)
[2025-05-16 05:53:21,636] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.8831; image: torch.Size([1, 258, 258, 431])(torch.float32)
[2025-05-16 05:53:21,637] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 258, 258, 431])(torch.float32)
[2025-05-16 05:53:21,639] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 05:53:21,639] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_ct_segresnet.ckpt
[2025-05-16 05:54:08,628] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-16 05:54:08,629] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:54:08,833] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.2027; image: torch.Size([3, 512, 512, 130])(torch.float32); pred: torch.Size([3, 258, 258, 431])(torch.float32)
[2025-05-16 05:54:08,836] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0026; image: torch.Size([3, 512, 512, 130])(torch.float32); pred: torch.Size([3, 258, 258, 431])(torch.float32)
[2025-05-16 05:54:08,837] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-16 05:54:08,837] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 05:54:08,839] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 258, 258, 431])(torch.float32); pred: torch.Size([3, 512, 512, 130])(torch.float32)
[2025-05-16 05:54:08,854] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0152; image: torch.Size([1, 258, 258, 431])(torch.float32); pred: torch.Size([3, 512, 512, 130])(torch.float32)
[2025-05-16 05:54:08,861] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0066; image: torch.Size([1, 258, 258, 431])(torch.float32); pred: torch.Size([1, 512, 512, 130])(torch.float32)
[2025-05-16 05:54:08,862] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 258, 258, 431])(torch.float32); pred: torch.Size([512, 512, 130])(torch.float32)
[2025-05-16 05:54:08,862] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-16 05:54:08,863] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-16 05:54:12,076] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 53.9467; Pre: 3.5079; Inferer: 46.9581; Invert: 0.2405; Post: 0.0258; Write: 3.2136
[2025-05-16 05:54:12,076] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpd9jbgm1o.nrrd
[2025-05-16 05:54:12,077] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-16 05:57:37,709] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml'}
[2025-05-16 05:57:38,040] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 05:57:38,482] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:57:38,576] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 05:57:38,577] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext', 'pinkcc_ct_segresnet']
[2025-05-16 05:57:38,577] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 05:57:38,578] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 05:57:38,601] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 05:57:38,601] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-16 05:57:38,841] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe186907f40>
[2025-05-16 05:57:38,905] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe186906bf0>
[2025-05-16 05:57:38,912] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 05:57:38,913] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:57:38,913] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fe186833490>
[2025-05-16 05:57:38,914] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 05:57:38,920] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe186907f40>, 'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fe186906bf0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fe186907f70>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fe1867a0910>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fe1867a2c50>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fe186862d40>}
[2025-05-16 05:57:39,050] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fe186d1bfd0>
[2025-05-16 05:57:39,114] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fe186827ac0>
[2025-05-16 05:57:39,114] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 05:57:39,115] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 05:57:39,116] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-16 05:57:39,117] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 05:57:39,117] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fe18683d7e0>
[2025-05-16 05:57:39,117] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-16 06:01:11,276] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-16 06:01:11,285] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 5; Weight: 1747375271
[2025-05-16 06:01:11,407] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '5', 'weight': 1747375271, 'path': '/data/5.nii.gz', 'ts': 1747365741, 'name': '5.nii.gz'}
[2025-05-16 06:01:22,799] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '5', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-16 06:01:22,800] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/5.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-16 06:01:22,817] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-16 06:01:22,817] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-16 06:01:23,822] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.0039; image: torch.Size([512, 512, 96])(torch.float32)
[2025-05-16 06:01:23,823] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.001; image: torch.Size([1, 512, 512, 96])(torch.float32)
[2025-05-16 06:01:23,842] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0188; image: torch.Size([1, 512, 512, 96])(torch.float32)
[2025-05-16 06:01:23,933] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0899; image: torch.Size([1, 512, 512, 96])(torch.float32)
[2025-05-16 06:01:26,122] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 2.1887; image: torch.Size([1, 326, 326, 318])(torch.float32)
[2025-05-16 06:01:26,122] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 326, 326, 318])(torch.float32)
[2025-05-16 06:01:26,124] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-16 06:01:26,125] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_ct_segresnet.ckpt
[2025-05-16 06:02:31,042] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-16 06:02:31,043] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 06:02:31,241] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.1964; image: torch.Size([3, 512, 512, 96])(torch.float32); pred: torch.Size([3, 326, 326, 318])(torch.float32)
[2025-05-16 06:02:31,244] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0026; image: torch.Size([3, 512, 512, 96])(torch.float32); pred: torch.Size([3, 326, 326, 318])(torch.float32)
[2025-05-16 06:02:31,245] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-16 06:02:31,245] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-16 06:02:31,247] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 326, 326, 318])(torch.float32); pred: torch.Size([3, 512, 512, 96])(torch.float32)
[2025-05-16 06:02:31,262] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0152; image: torch.Size([1, 326, 326, 318])(torch.float32); pred: torch.Size([3, 512, 512, 96])(torch.float32)
[2025-05-16 06:02:31,269] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0067; image: torch.Size([1, 326, 326, 318])(torch.float32); pred: torch.Size([1, 512, 512, 96])(torch.float32)
[2025-05-16 06:02:31,269] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 326, 326, 318])(torch.float32); pred: torch.Size([512, 512, 96])(torch.float32)
[2025-05-16 06:02:31,270] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-16 06:02:31,271] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-16 06:02:34,505] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 71.7052; Pre: 3.3227; Inferer: 64.8783; Invert: 0.2426; Post: 0.0258; Write: 3.2351
[2025-05-16 06:02:34,505] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpbp_0np_e.nrrd
[2025-05-16 06:02:34,506] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-16 06:03:07,051] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:101) - Saving Label for 5 for tag: final by admin
[2025-05-16 06:03:07,052] [1] [MainThread] [INFO] (monailabel.endpoints.datastore:112) - Save Label params: {"label_info": [{"name": "spleen", "idx": 2}, {"name": "right_kidney", "idx": 3}, {"name": "left_kidney", "idx": 4}, {"name": "gall_bladder", "idx": 5}, {"name": "esophagus", "idx": 6}, {"name": "liver", "idx": 7}, {"name": "stomach", "idx": 8}, {"name": "arotas", "idx": 9}, {"name": "postcava", "idx": 10}, {"name": "pancreas", "idx": 11}, {"name": "right_adrenal_gland", "idx": 12}, {"name": "left_adrenal_gland", "idx": 13}, {"name": "duodenum", "idx": 14}, {"name": "bladder", "idx": 15}, {"name": "prostate_uterus", "idx": 16}, {"name": "tumor", "idx": 17}, {"name": "metastasis", "idx": 18}], "client_id": "user-xyz"}
[2025-05-16 06:03:07,052] [1] [MainThread] [INFO] (monailabel.datastore.local:486) - Saving Label for Image: 5; Tag: final; Info: {'label_info': [{'name': 'spleen', 'idx': 2}, {'name': 'right_kidney', 'idx': 3}, {'name': 'left_kidney', 'idx': 4}, {'name': 'gall_bladder', 'idx': 5}, {'name': 'esophagus', 'idx': 6}, {'name': 'liver', 'idx': 7}, {'name': 'stomach', 'idx': 8}, {'name': 'arotas', 'idx': 9}, {'name': 'postcava', 'idx': 10}, {'name': 'pancreas', 'idx': 11}, {'name': 'right_adrenal_gland', 'idx': 12}, {'name': 'left_adrenal_gland', 'idx': 13}, {'name': 'duodenum', 'idx': 14}, {'name': 'bladder', 'idx': 15}, {'name': 'prostate_uterus', 'idx': 16}, {'name': 'tumor', 'idx': 17}, {'name': 'metastasis', 'idx': 18}], 'client_id': 'user-xyz'}
[2025-05-16 06:03:07,053] [1] [MainThread] [INFO] (monailabel.datastore.local:494) - Adding Label: 5 => final => /tmp/tmpo1sewuid.nii.gz
[2025-05-16 06:03:07,057] [1] [MainThread] [INFO] (monailabel.datastore.local:510) - Label Info: {'label_info': [{'name': 'spleen', 'idx': 2}, {'name': 'right_kidney', 'idx': 3}, {'name': 'left_kidney', 'idx': 4}, {'name': 'gall_bladder', 'idx': 5}, {'name': 'esophagus', 'idx': 6}, {'name': 'liver', 'idx': 7}, {'name': 'stomach', 'idx': 8}, {'name': 'arotas', 'idx': 9}, {'name': 'postcava', 'idx': 10}, {'name': 'pancreas', 'idx': 11}, {'name': 'right_adrenal_gland', 'idx': 12}, {'name': 'left_adrenal_gland', 'idx': 13}, {'name': 'duodenum', 'idx': 14}, {'name': 'bladder', 'idx': 15}, {'name': 'prostate_uterus', 'idx': 16}, {'name': 'tumor', 'idx': 17}, {'name': 'metastasis', 'idx': 18}], 'client_id': 'user-xyz', 'ts': 1747375387, 'name': '5.nii.gz'}
[2025-05-16 06:03:07,060] [1] [MainThread] [INFO] (monailabel.interfaces.app:493) - New label saved for: 5 => 5
[2025-05-16 06:03:07,200] [1] [Thread-2] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 06:03:21,806] [1] [MainThread] [INFO] (monailabel.utils.async_tasks.task:41) - Train request: {'model': 'pinkcc_ct_segresnet', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'user-xyz'}
[2025-05-16 06:03:21,807] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:49) - Before:: /usr::/apps/radiology
[2025-05-16 06:03:21,808] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:53) - After:: /usr::/apps/radiology
[2025-05-16 06:03:21,809] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:65) - COMMAND:: /usr/bin/python -m monailabel.interfaces.utils.app -m train -r {"model":"pinkcc_ct_segresnet","name":"train_01","pretrained":true,"device":"Tesla P100-PCIE-16GB:0","max_epochs":100,"early_stop_patience":-1,"val_split":0.2,"train_batch_size":1,"val_batch_size":1,"multi_gpu":true,"gpus":"all","dataset":"SmartCacheDataset","dataloader":"ThreadDataLoader","tracking":"mlflow","tracking_uri":"","tracking_experiment_name":"","client_id":"user-xyz"}
[2025-05-16 06:03:22,277] [93] [MainThread] [INFO] (__main__:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml'}
[2025-05-16 06:03:29,692] [93] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-16 06:03:29,920] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 06:03:30,013] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-16 06:03:30,013] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext', 'pinkcc_ct_segresnet']
[2025-05-16 06:03:30,013] [93] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-16 06:03:30,014] [93] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: False; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-16 06:03:30,028] [93] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-16 06:03:30,244] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f17081980a0>
[2025-05-16 06:03:30,312] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f17081980d0>
Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
[2025-05-16 06:03:30,319] [93] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-16 06:03:30,319] [timeloop] [INFO] Starting Timeloop..
[2025-05-16 06:03:30,319] [93] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-16 06:03:30,320] [timeloop] [INFO] Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f17080dad40>
[2025-05-16 06:03:30,320] [93] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f17080dad40>
[2025-05-16 06:03:30,320] [timeloop] [INFO] Timeloop now started. Jobs will run based on the interval set
[2025-05-16 06:03:30,320] [93] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
[2025-05-16 06:03:30,325] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f17081980a0>, 'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f17081980d0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f1708366d10>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f17081bdf90>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f1708743310>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f1708437eb0>}
[2025-05-16 06:03:30,463] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f17080a8280>
[2025-05-16 06:03:30,530] [93] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f17080ed150>
[2025-05-16 06:03:30,530] [93] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-16 06:03:30,530] [93] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-16 06:03:30,530] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:436) - Train Request (input): {'model': 'pinkcc_ct_segresnet', 'name': 'train_01', 'pretrained': True, 'device': 'Tesla P100-PCIE-16GB:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'client_id': 'user-xyz', 'local_rank': 0}
[2025-05-16 06:03:30,531] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:449) - CUDA_VISIBLE_DEVICES: None
[2025-05-16 06:03:30,531] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:459) - Distributed/Multi GPU Training = TRUE
[2025-05-16 06:03:30,531] [93] [MainThread] [INFO] (monailabel.tasks.train.basic_train:465) - Total proces to spawn: 2
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
/usr/local/lib/python3.10/dist-packages/ignite/handlers/checkpoint.py:17: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
[2025-05-16 06:03:38.323][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 1
[2025-05-16 06:03:38.323][ INFO](monailabel.tasks.train.basic_train) - 1 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pinkcc_ct_segresnet', 'client_id': 'user-xyz', 'local_rank': 0, 'run_id': '20250516_060330'}
[2025-05-16 06:03:38.565][ INFO](monailabel.tasks.train.basic_train) - Main Worker: 0
[2025-05-16 06:03:38.565][ INFO](monailabel.tasks.train.basic_train) - 0 - Train Request (final): {'name': 'train_01', 'pretrained': True, 'device': 'cuda:0', 'max_epochs': 100, 'early_stop_patience': -1, 'val_split': 0.2, 'train_batch_size': 1, 'val_batch_size': 1, 'multi_gpu': True, 'gpus': 'all', 'dataset': 'SmartCacheDataset', 'dataloader': 'ThreadDataLoader', 'tracking': 'mlflow', 'tracking_uri': '', 'tracking_experiment_name': '', 'model': 'pinkcc_ct_segresnet', 'client_id': 'user-xyz', 'local_rank': 0, 'run_id': '20250516_060330'}
[2025-05-16 06:03:38.957][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:0 => Using GPU-0
[2025-05-16 06:03:38.957][ INFO](monailabel.tasks.train.basic_train) - ++++ Rank:1 => Using GPU-1
[2025-05-16 06:03:39.010][ INFO](monailabel.tasks.train.basic_train) - 0 - Using Device: cuda:0; IDX: 0
[2025-05-16 06:03:39.010][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pinkcc_ct_segresnet/train_01
[2025-05-16 06:03:39.010][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-16 06:03:39.011][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pinkcc_ct_segresnet/train_01/mlruns;
[2025-05-16 06:03:39.011][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pinkcc_ct_segresnet; Run Name: run_20250516_060330
[2025-05-16 06:03:39.011][ INFO](monailabel.tasks.train.basic_train) - Total Records for Training: 3
[2025-05-16 06:03:39.011][ INFO](monailabel.tasks.train.basic_train) - Total Records for Validation: 1
[2025-05-16 06:03:39.454][ INFO](monailabel.tasks.train.basic_train) - 1 - Using Device: cuda:1; IDX: 1
[2025-05-16 06:03:39.454][ INFO](monailabel.tasks.train.basic_train) - Run/Output Path: /apps/radiology/model/pinkcc_ct_segresnet/train_01
[2025-05-16 06:03:39.454][ INFO](monailabel.tasks.train.basic_train) - Tracking: mlflow
[2025-05-16 06:03:39.455][ INFO](monailabel.tasks.train.basic_train) - Tracking URI: file:///apps/radiology/model/pinkcc_ct_segresnet/train_01/mlruns;
[2025-05-16 06:03:39.455][ INFO](monailabel.tasks.train.basic_train) - Tracking Experiment Name: pinkcc_ct_segresnet; Run Name: run_20250516_060330
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 9258.95it/s]
[2025-05-16 06:03:39.807][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Validation: 1
[2025-05-16 06:03:39.820][ INFO](monailabel.tasks.train.basic_train) - 0 - Adding Validation to run every '1' interval
[2025-05-16 06:03:39.821][ INFO](monailabel.tasks.train.basic_train) - 0 - Load Path /apps/radiology/model/pinkcc_ct_segresnet/train_01/best_model.ckpt
Loading dataset:   0%|          | 0/1 [00:00<?, ?it/s]
Loading dataset: 100%|██████████| 1/1 [00:00<00:00, 10672.53it/s]
[2025-05-16 06:03:39.825][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Validation: 1
[2025-05-16 06:03:39.829][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7fe77d22ad70> to <monai.transforms.compose.Compose object at 0x7fe77bf868c0>
[2025-05-16 06:03:39.830][ INFO](monailabel.tasks.train.basic_train) - 1 - Adding Validation to run every '1' interval
[2025-05-16 06:03:39.830][ INFO](monailabel.tasks.train.basic_train) - 1 - Load Path /apps/radiology/model/pinkcc_ct_segresnet/train_01/best_model.ckpt
Loading dataset:   0%|          | 0/2 [00:00<?, ?it/s][2025-05-16 06:03:39.834][WARNING](DatasetBuilder) - Overwrite kwargs from <monai.transforms.compose.Compose object at 0x7f2e38173520> to <monai.transforms.compose.Compose object at 0x7f2e3710c310>
Loading dataset:   0%|          | 0/2 [00:00<?, ?it/s]
Loading dataset:  50%|█████     | 1/2 [00:10<00:10, 10.67s/it]
Loading dataset: 100%|██████████| 2/2 [00:10<00:00,  5.34s/it]
[2025-05-16 06:03:50.507][ INFO](monailabel.tasks.train.basic_train) - 0 - Records for Training: 2
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-16 06:03:50.521][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-16 06:03:50.769][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/pinkcc_ct_segresnet/train_01/best_model.ckpt
Num foregrounds 0, Num backgrounds 12284692, unable to generate class balanced samples, setting `pos_ratio` to 0.
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
Loading dataset:  50%|█████     | 1/2 [00:13<00:13, 13.32s/it]
Loading dataset: 100%|██████████| 2/2 [00:13<00:00,  6.66s/it]
[2025-05-16 06:03:53.168][ INFO](monailabel.tasks.train.basic_train) - 1 - Records for Training: 2
`torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
[2025-05-16 06:03:53.182][ INFO](ignite.engine.engine.SupervisedTrainer) - Engine run resuming from iteration 0, epoch 0 until 100 epochs
You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
[2025-05-16 06:03:53.224][ INFO](ignite.engine.engine.SupervisedTrainer) - Restored all variables from /apps/radiology/model/pinkcc_ct_segresnet/train_01/best_model.ckpt
`torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
2025-05-16 06:03:56,641 - INFO - Epoch: 1/100, Iter: 1/2 -- train_loss: 0.8720
Num foregrounds 0, Num backgrounds 12284692, unable to generate class balanced samples, setting `pos_ratio` to 0.
2025-05-16 06:03:59,102 - INFO - Epoch: 1/100, Iter: 2/2 -- train_loss: 1.1239
[2025-05-16 06:03:59.186][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.5546679496765137
[2025-05-16 06:03:59.186][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 2.622518262958235e-05
[2025-05-16 06:03:59.186][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 0 until 1 epochs
[2025-05-16 06:03:59.194][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.5546679496765137
[2025-05-16 06:03:59.194][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 2.622518262958235e-05
2025-05-16 06:03:59,194 - INFO - Epoch[1] Metrics -- train_mean_dice: 0.5547
2025-05-16 06:03:59,194 - INFO - Key metric: train_mean_dice best value: 0.5546679496765137 at epoch: 1
[2025-05-16 06:03:59.201][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 0 until 1 epochs
[2025-05-16 06:05:27.532][ INFO](ignite.engine.engine.SupervisedEvaluator) - Got new best metric of val_mean_dice: 0.9398839473724365
2025-05-16 06:05:27,533 - INFO - Epoch[1] Metrics -- val_mean_dice: 0.9399
2025-05-16 06:05:27,533 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 06:05:27.533][ INFO](ignite.engine.engine.SupervisedEvaluator) - Got new best metric of val_mean_dice: 0.9398839473724365
[2025-05-16 06:05:27.534][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[1] Complete. Time taken: 00:01:28.347
[2025-05-16 06:05:27.534][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:01:28.348
[2025-05-16 06:05:27.534][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[1] Complete. Time taken: 00:01:34.309
[2025-05-16 06:05:27.765][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[1] Complete. Time taken: 00:01:28.486
[2025-05-16 06:05:27.769][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:01:28.568
[2025-05-16 06:05:27.950][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[1] Complete. Time taken: 00:01:37.181
2025-05-16 06:05:30,753 - INFO - Epoch: 2/100, Iter: 1/2 -- train_loss: 0.6872
2025-05-16 06:05:33,020 - INFO - Epoch: 2/100, Iter: 2/2 -- train_loss: 0.7822
[2025-05-16 06:05:33.092][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.6949219703674316
[2025-05-16 06:05:33.092][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.6949219703674316
[2025-05-16 06:05:33.092][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 5.24503652591647e-05
2025-05-16 06:05:33,092 - INFO - Epoch[2] Metrics -- train_mean_dice: 0.6949
[2025-05-16 06:05:33.092][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 5.24503652591647e-05
2025-05-16 06:05:33,093 - INFO - Key metric: train_mean_dice best value: 0.6949219703674316 at epoch: 2
[2025-05-16 06:05:33.093][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 1 until 2 epochs
[2025-05-16 06:05:33.119][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 1 until 2 epochs
2025-05-16 06:06:10,139 - INFO - Epoch[2] Metrics -- val_mean_dice: 0.9240
2025-05-16 06:06:10,139 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 06:06:10.140][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[2] Complete. Time taken: 00:00:37.047
[2025-05-16 06:06:10.140][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:37.047
[2025-05-16 06:06:10.140][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[2] Complete. Time taken: 00:00:42.606
[2025-05-16 06:06:10.148][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[2] Complete. Time taken: 00:00:36.469
[2025-05-16 06:06:10.152][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:37.033
[2025-05-16 06:06:10.360][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[2] Complete. Time taken: 00:00:42.410
2025-05-16 06:06:12,694 - INFO - Epoch: 3/100, Iter: 1/2 -- train_loss: 0.7308
2025-05-16 06:06:15,812 - INFO - Epoch: 3/100, Iter: 2/2 -- train_loss: 0.6011
[2025-05-16 06:06:15.858][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 7.867554788874704e-05
[2025-05-16 06:06:15.858][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 7.867554788874704e-05
2025-05-16 06:06:15,858 - INFO - Epoch[3] Metrics -- train_mean_dice: 0.4930
2025-05-16 06:06:15,858 - INFO - Key metric: train_mean_dice best value: 0.6949219703674316 at epoch: 2
[2025-05-16 06:06:15.858][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 2 until 3 epochs
[2025-05-16 06:06:15.862][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 2 until 3 epochs
2025-05-16 06:06:50,878 - INFO - Epoch[3] Metrics -- val_mean_dice: 0.8640
2025-05-16 06:06:50,878 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 06:06:50.879][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[3] Complete. Time taken: 00:00:35.020
[2025-05-16 06:06:50.879][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.021
[2025-05-16 06:06:50.880][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[3] Complete. Time taken: 00:00:40.739
[2025-05-16 06:06:50.887][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[3] Complete. Time taken: 00:00:34.942
[2025-05-16 06:06:50.891][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.029
[2025-05-16 06:06:50.891][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[3] Complete. Time taken: 00:00:40.531
2025-05-16 06:06:53,746 - INFO - Epoch: 4/100, Iter: 1/2 -- train_loss: 0.5980
2025-05-16 06:06:56,148 - INFO - Epoch: 4/100, Iter: 2/2 -- train_loss: 0.7200
[2025-05-16 06:06:56.156][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.7684874534606934
[2025-05-16 06:06:56.156][ INFO](ignite.engine.engine.SupervisedTrainer) - Got new best metric of train_mean_dice: 0.7684874534606934
[2025-05-16 06:06:56.156][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001049007305183294
2025-05-16 06:06:56,156 - INFO - Epoch[4] Metrics -- train_mean_dice: 0.7685
2025-05-16 06:06:56,156 - INFO - Key metric: train_mean_dice best value: 0.7684874534606934 at epoch: 4
[2025-05-16 06:06:56.156][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001049007305183294
[2025-05-16 06:06:56.156][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 3 until 4 epochs
[2025-05-16 06:06:56.161][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 3 until 4 epochs
2025-05-16 06:07:31,224 - INFO - Epoch[4] Metrics -- val_mean_dice: 0.7930
2025-05-16 06:07:31,224 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 06:07:31.224][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[4] Complete. Time taken: 00:00:35.067
[2025-05-16 06:07:31.224][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.068
[2025-05-16 06:07:31.224][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[4] Complete. Time taken: 00:00:40.345
[2025-05-16 06:07:31.389][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[4] Complete. Time taken: 00:00:35.141
[2025-05-16 06:07:31.452][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:35.291
[2025-05-16 06:07:31.835][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[4] Complete. Time taken: 00:00:40.943
2025-05-16 06:07:33,530 - INFO - Epoch: 5/100, Iter: 1/2 -- train_loss: 0.9530
2025-05-16 06:07:36,744 - INFO - Epoch: 5/100, Iter: 2/2 -- train_loss: 0.6711
[2025-05-16 06:07:36.753][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00013112591314791175
2025-05-16 06:07:36,753 - INFO - Epoch[5] Metrics -- train_mean_dice: 0.6894
2025-05-16 06:07:36,753 - INFO - Key metric: train_mean_dice best value: 0.7684874534606934 at epoch: 4
[2025-05-16 06:07:36.753][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.00013112591314791175
[2025-05-16 06:07:36.754][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 4 until 5 epochs
[2025-05-16 06:07:36.757][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 4 until 5 epochs
[2025-05-16 06:08:11.648][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[5] Complete. Time taken: 00:00:34.894
[2025-05-16 06:08:11.649][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.895
[2025-05-16 06:08:11.649][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[5] Complete. Time taken: 00:00:40.424
2025-05-16 06:08:11,648 - INFO - Epoch[5] Metrics -- val_mean_dice: 0.7080
2025-05-16 06:08:11,649 - INFO - Key metric: val_mean_dice best value: 0.9398839473724365 at epoch: 1
[2025-05-16 06:08:11.658][ INFO](ignite.engine.engine.SupervisedEvaluator) - Epoch[5] Complete. Time taken: 00:00:34.806
[2025-05-16 06:08:11.661][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run complete. Time taken: 00:00:34.904
[2025-05-16 06:08:11.661][ INFO](ignite.engine.engine.SupervisedTrainer) - Epoch[5] Complete. Time taken: 00:00:39.826
2025-05-16 06:08:13,949 - INFO - Epoch: 6/100, Iter: 1/2 -- train_loss: 0.6689
2025-05-16 06:08:16,949 - INFO - Epoch: 6/100, Iter: 2/2 -- train_loss: 0.7318
[2025-05-16 06:08:16.960][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001573510957774941
[2025-05-16 06:08:16.960][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 5 until 6 epochs
[2025-05-16 06:08:16.960][ INFO](ignite.engine.engine.SupervisedTrainer) - Current learning rate: 0.0001573510957774941
2025-05-16 06:08:16,960 - INFO - Epoch[6] Metrics -- train_mean_dice: 0.6833
2025-05-16 06:08:16,960 - INFO - Key metric: train_mean_dice best value: 0.7684874534606934 at epoch: 4
[2025-05-16 06:08:16.964][ INFO](ignite.engine.engine.SupervisedEvaluator) - Engine run resuming from iteration 0, epoch 5 until 6 epochs
-------------------------------------------------------------------------------
runpy.py 196 _run_module_as_main
return _run_code(code, main_globals, None,
runpy.py 86 _run_code
exec(code, run_globals)
app.py 128 <module>
run_main()
app.py 113 run_main
result = a.train(request)
app.py 423 [2025-05-16 06:08:39.944][ERROR](ignite.engine.engine.SupervisedEvaluator) - Engine run is terminating due to exception:
train
result = task(request, self.datastore())
basic_train.py [2025-05-16 06:08:39.944][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception:
466 __call__
torch.multiprocessing.spawn(main_worker, nprocs=world_size, args=(world_size, req, datalist, self))
spawn.py 328 spawn
return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
spawn.py 284 start_processes
while not context.join():
spawn.py 132 join
ready = multiprocessing.connection.wait(
connection.py 931 wait
ready = selector.select(timeout)
selectors.py 416 select
fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
[2025-05-16 06:08:39.948][ERROR](ignite.engine.engine.SupervisedEvaluator) - Engine run is terminating due to exception:
2025-05-16 06:08:39,949 - ERROR - Exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/evaluator.py", line 334, in _iteration
    engine.state.output[Keys.PRED] = engine.inferer(inputs, engine.network, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/inferer.py", line 532, in __call__
    return sliding_window_inference(
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/utils.py", line 229, in sliding_window_inference
    seg_prob_out = predictor(win_data, *args, **kwargs)  # batched patch
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 180, in forward
    x, down_x = self.encode(x)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 164, in encode
    x = down(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/blocks/segresnet_block.py", line 86, in forward
    x = self.norm1(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/normalization.py", line 313, in forward
    return F.group_norm(input, self.num_groups, self.weight, self.bias, self.eps)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 2955, in group_norm
    return torch.group_norm(
KeyboardInterrupt
[2025-05-16 06:08:39.953][ERROR](ignite.engine.engine.SupervisedTrainer) - Engine run is terminating due to exception:
2025-05-16 06:08:39,953 - ERROR - Exception:
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 965, in _internal_run_as_gen
    self._fire_event(Events.EPOCH_COMPLETED)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/validation_handler.py", line 85, in __call__
    self.validator.run(engine.state.epoch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/evaluator.py", line 150, in run
    super().run()
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/workflow.py", line 282, in run
    super().run(data=self.data_loader, max_epochs=self.state.max_epochs)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 892, in run
    return self._internal_run()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 935, in _internal_run
    return next(self._internal_run_generator)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 993, in _internal_run_as_gen
    self._handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 636, in _handle_exception
    self._fire_event(Events.EXCEPTION_RAISED, e)
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 425, in _fire_event
    func(*first, *(event_args + others), **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/handlers/stats_handler.py", line 201, in exception_raised
    raise e
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 959, in _internal_run_as_gen
    epoch_time_taken += yield from self._run_once_on_dataset_as_gen()
  File "/usr/local/lib/python3.10/dist-packages/ignite/engine/engine.py", line 1068, in _run_once_on_dataset_as_gen
    self.state.output = self._process_function(self, self.state.batch)
  File "/usr/local/lib/python3.10/dist-packages/monai/engines/evaluator.py", line 334, in _iteration
    engine.state.output[Keys.PRED] = engine.inferer(inputs, engine.network, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/inferer.py", line 532, in __call__
    return sliding_window_inference(
  File "/usr/local/lib/python3.10/dist-packages/monai/inferers/utils.py", line 229, in sliding_window_inference
    seg_prob_out = predictor(win_data, *args, **kwargs)  # batched patch
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1643, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 180, in forward
    x, down_x = self.encode(x)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/nets/segresnet.py", line 164, in encode
    x = down(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/monai/networks/blocks/segresnet_block.py", line 86, in forward
    x = self.norm1(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/normalization.py", line 313, in forward
    return F.group_norm(input, self.num_groups, self.weight, self.bias, self.eps)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/functional.py", line 2955, in group_norm
    return torch.group_norm(
KeyboardInterrupt
[rank0]:[W516 06:08:40.616237778 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
[2025-05-16 06:08:43,158] [1] [ThreadPoolExecutor-0_0] [INFO] (monailabel.utils.async_tasks.utils:83) - Return code: -2
[2025-05-18 12:25:08,532] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml,config/active_learning_FL.yaml'}
[2025-05-18 12:25:08,866] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-18 12:25:09,310] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 12:27:04,574] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml,config/active_learning_FL.yaml'}
[2025-05-18 12:27:04,909] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-18 12:27:05,330] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 12:27:05,434] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 12:27:05,527] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 12:27:05,528] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['FL_ct_mednext', 'pan_mri_mednext', 'pinkcc_ct_segresnet']
[2025-05-18 12:27:05,528] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-18 12:27:05,529] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-18 12:27:05,554] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-18 12:27:05,554] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-18 12:27:06,099] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: FL_ct_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fb7ee24bc40>
[2025-05-18 12:27:06,232] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fb7ee26cfd0>
[2025-05-18 12:27:06,297] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fb7ee26d000>
[2025-05-18 12:27:06,304] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-18 12:27:06,305] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-18 12:27:06,306] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fb7ec4cad40>
[2025-05-18 12:27:06,306] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-18 12:27:06,312] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'FL_ct_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fb7ee24bc40>, 'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fb7ee26cfd0>, 'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fb7ee26d000>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fb7ec5266e0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fb7ec527af0>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fb7ec5e3bb0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fb7ee3735b0>}
[2025-05-18 12:27:06,439] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: FL_ct_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fb7ec4a3ca0>
[2025-05-18 12:27:06,568] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fb7ee668910>
[2025-05-18 12:27:06,631] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fb7ec4eb0a0>
[2025-05-18 12:27:06,632] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-18 12:27:06,632] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-18 12:27:06,633] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-18 12:27:06,634] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-18 12:27:06,634] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fb7ec4ed090>
[2025-05-18 12:27:06,635] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-18 12:27:33,095] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-18 12:27:33,098] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 30; Weight: 1747571253
[2025-05-18 12:27:33,145] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '30', 'weight': 1747571253, 'path': '/data/30.nii.gz', 'ts': 1747365741, 'name': '30.nii.gz'}
[2025-05-18 12:28:03,777] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'FL_ct_mednext', 'image': '30', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-18 12:28:03,778] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'FL_ct_mednext', 'image': '/data/30.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'MedNeXt multiorgan segmentaion model open CT dataset.\n'}
[2025-05-18 12:28:03,795] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-18 12:28:03,795] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-18 12:28:05,100] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.3035; image: torch.Size([512, 512, 124])(torch.float32)
[2025-05-18 12:28:05,101] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0009; image: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:05,124] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0219; image: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:07,646] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 2.5216; image: torch.Size([1, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:07,721] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityRanged): Time: 0.0749; image: torch.Size([1, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:07,721] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:07,723] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [128, 128, 128], 'sw_batch_size': 1, 'overlap': 0.25, 'mode': constant, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-18 12:28:07,724] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/best_FL_pancreas_model.pt
[2025-05-18 12:28:17,698] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-18 12:28:17,699] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:28:17,908] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.2076; image: torch.Size([8, 512, 512, 124])(torch.float32); pred: torch.Size([8, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:17,911] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0026; image: torch.Size([8, 512, 512, 124])(torch.float32); pred: torch.Size([8, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:17,912] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-18 12:28:17,913] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:28:17,914] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([8, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:17,945] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0314; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([8, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:17,956] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0108; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:17,957] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([512, 512, 124])(torch.float32)
[2025-05-18 12:28:17,957] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-18 12:28:17,958] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-18 12:28:21,423] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 17.6457; Pre: 3.9436; Inferer: 9.9365; Invert: 0.2530; Post: 0.0459; Write: 3.4659
[2025-05-18 12:28:21,424] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpomyv917_.nrrd
[2025-05-18 12:28:21,424] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-18 12:28:52,148] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '30', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-18 12:28:52,149] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/30.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-18 12:28:52,151] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-18 12:28:52,151] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-18 12:28:53,458] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.305; image: torch.Size([512, 512, 124])(torch.float32)
[2025-05-18 12:28:53,458] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0002; image: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:53,472] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0137; image: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:53,580] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.1075; image: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:28:56,102] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 2.5214; image: torch.Size([1, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:56,103] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 308, 308, 411])(torch.float32)
[2025-05-18 12:28:56,104] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-18 12:28:56,104] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_ct_segresnet.ckpt
[2025-05-18 12:30:08,784] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-18 12:30:08,785] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:30:08,813] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.0264; image: torch.Size([3, 512, 512, 124])(torch.float32); pred: torch.Size([3, 308, 308, 411])(torch.float32)
[2025-05-18 12:30:08,816] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0024; image: torch.Size([3, 512, 512, 124])(torch.float32); pred: torch.Size([3, 308, 308, 411])(torch.float32)
[2025-05-18 12:30:08,817] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-18 12:30:08,817] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:30:08,818] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([3, 512, 512, 124])(torch.float32)
[2025-05-18 12:30:08,819] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0003; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([3, 512, 512, 124])(torch.float32)
[2025-05-18 12:30:08,820] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0004; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([1, 512, 512, 124])(torch.float32)
[2025-05-18 12:30:08,820] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 308, 308, 411])(torch.float32); pred: torch.Size([512, 512, 124])(torch.float32)
[2025-05-18 12:30:08,820] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-18 12:30:08,821] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-18 12:30:09,216] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 77.0671; Pre: 3.9541; Inferer: 72.6254; Invert: 0.0873; Post: 0.0043; Write: 0.3950
[2025-05-18 12:30:09,216] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmpbnk_qhpr.nrrd
[2025-05-18 12:30:09,217] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-18 12:31:03,298] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-18 12:31:03,301] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 49; Weight: 1747571463
[2025-05-18 12:31:03,406] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '49', 'weight': 1747571463, 'path': '/data/49.nii.gz', 'ts': 1747365741, 'name': '49.nii.gz'}
[2025-05-18 12:31:14,674] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '49', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-18 12:31:14,675] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/49.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-18 12:31:14,678] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-18 12:31:14,678] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-18 12:31:15,632] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.9525; image: torch.Size([512, 512, 92])(torch.float32)
[2025-05-18 12:31:15,632] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0002; image: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:31:15,648] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0148; image: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:31:15,743] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.0944; image: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:31:17,421] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.6779; image: torch.Size([1, 274, 274, 304])(torch.float32)
[2025-05-18 12:31:17,422] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 274, 274, 304])(torch.float32)
[2025-05-18 12:31:17,423] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-18 12:31:17,423] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_ct_segresnet.ckpt
[2025-05-18 12:31:56,632] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-18 12:31:56,632] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:31:56,659] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.0251; image: torch.Size([3, 512, 512, 92])(torch.float32); pred: torch.Size([3, 274, 274, 304])(torch.float32)
[2025-05-18 12:31:56,662] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0026; image: torch.Size([3, 512, 512, 92])(torch.float32); pred: torch.Size([3, 274, 274, 304])(torch.float32)
[2025-05-18 12:31:56,663] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-18 12:31:56,663] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:31:56,664] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([3, 512, 512, 92])(torch.float32)
[2025-05-18 12:31:56,665] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0004; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([3, 512, 512, 92])(torch.float32)
[2025-05-18 12:31:56,666] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0004; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:31:56,666] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([512, 512, 92])(torch.float32)
[2025-05-18 12:31:56,666] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-18 12:31:56,667] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-18 12:31:56,953] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 42.2785; Pre: 2.7469; Inferer: 39.1719; Invert: 0.0676; Post: 0.0043; Write: 0.2866
[2025-05-18 12:31:56,953] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmp8076090a.nrrd
[2025-05-18 12:31:56,954] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-18 12:32:42,568] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'FL_ct_mednext', 'image': '49', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-18 12:32:42,570] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'FL_ct_mednext', 'image': '/data/49.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'MedNeXt multiorgan segmentaion model open CT dataset.\n'}
[2025-05-18 12:32:42,571] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-18 12:32:42,572] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-18 12:32:43,528] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 0.9556; image: torch.Size([512, 512, 92])(torch.float32)
[2025-05-18 12:32:43,529] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0003; image: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:32:43,543] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0132; image: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:32:45,057] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.5133; image: torch.Size([1, 274, 274, 304])(torch.float32)
[2025-05-18 12:32:45,104] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityRanged): Time: 0.0473; image: torch.Size([1, 274, 274, 304])(torch.float32)
[2025-05-18 12:32:45,105] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 274, 274, 304])(torch.float32)
[2025-05-18 12:32:45,106] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [128, 128, 128], 'sw_batch_size': 1, 'overlap': 0.25, 'mode': constant, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-18 12:32:45,106] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/best_FL_pancreas_model.pt
[2025-05-18 12:32:52,007] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-18 12:32:52,008] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:32:52,043] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.0344; image: torch.Size([8, 512, 512, 92])(torch.float32); pred: torch.Size([8, 274, 274, 304])(torch.float32)
[2025-05-18 12:32:52,046] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0026; image: torch.Size([8, 512, 512, 92])(torch.float32); pred: torch.Size([8, 274, 274, 304])(torch.float32)
[2025-05-18 12:32:52,048] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-18 12:32:52,048] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 12:32:52,049] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([8, 512, 512, 92])(torch.float32)
[2025-05-18 12:32:52,049] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0003; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([8, 512, 512, 92])(torch.float32)
[2025-05-18 12:32:52,050] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0004; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([1, 512, 512, 92])(torch.float32)
[2025-05-18 12:32:52,051] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 274, 274, 304])(torch.float32); pred: torch.Size([512, 512, 92])(torch.float32)
[2025-05-18 12:32:52,051] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-18 12:32:52,052] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-18 12:32:52,355] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 9.7864; Pre: 2.5355; Inferer: 6.8711; Invert: 0.0700; Post: 0.0043; Write: 0.3043
[2025-05-18 12:32:52,356] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmp5gi1rc8e.nrrd
[2025-05-18 12:32:52,356] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-18 14:48:20,424] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml,config/active_learning_FL.yaml'}
[2025-05-18 14:48:20,764] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-18 14:48:21,298] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 14:48:21,377] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 14:48:21,470] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-18 14:48:21,470] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext', 'FL_ct_mednext', 'pinkcc_ct_segresnet']
[2025-05-18 14:48:21,471] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-18 14:48:21,472] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-18 14:48:21,497] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-18 14:48:21,498] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-18 14:48:21,716] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fd838d0bfd0>
[2025-05-18 14:48:22,149] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: FL_ct_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fd8383ccc70>
[2025-05-18 14:48:22,213] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fd8383ccca0>
[2025-05-18 14:48:22,222] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-18 14:48:22,223] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-18 14:48:22,224] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7fd8208fed40>
[2025-05-18 14:48:22,224] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-18 14:48:22,229] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fd838d0bfd0>, 'FL_ct_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fd8383ccc70>, 'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7fd8383ccca0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fd820bc9b70>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7fd820bc9b40>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7fd820a2b670>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7fd8384df250>}
[2025-05-18 14:48:22,355] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fd820adb940>
[2025-05-18 14:48:22,481] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: FL_ct_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fd8387cc5b0>
[2025-05-18 14:48:22,544] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7fd820922d40>
[2025-05-18 14:48:22,545] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-18 14:48:22,545] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-18 14:48:22,546] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-18 14:48:22,547] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-18 14:48:22,547] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7fd820925090>
[2025-05-18 14:48:22,548] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-18 14:48:41,319] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-18 14:48:41,322] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 20; Weight: 1747579721
[2025-05-18 14:48:41,327] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '20', 'weight': 1747579721, 'path': '/data/20.nii.gz', 'ts': 1747365741, 'name': '20.nii.gz'}
[2025-05-18 14:49:17,309] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'FL_ct_mednext', 'image': '20', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-18 14:49:17,310] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'FL_ct_mednext', 'image': '/data/20.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'MedNeXt multiorgan segmentaion model open CT dataset.\n'}
[2025-05-18 14:49:17,327] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-18 14:49:17,327] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-18 14:49:18,994] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.6657; image: torch.Size([512, 512, 132])(torch.float32)
[2025-05-18 14:49:18,996] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0009; image: torch.Size([1, 512, 512, 132])(torch.float32)
[2025-05-18 14:49:19,019] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0231; image: torch.Size([1, 512, 512, 132])(torch.float32)
[2025-05-18 14:49:21,163] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 2.1433; image: torch.Size([1, 271, 271, 438])(torch.float32)
[2025-05-18 14:49:21,234] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (NormalizeIntensityRanged): Time: 0.0707; image: torch.Size([1, 271, 271, 438])(torch.float32)
[2025-05-18 14:49:21,234] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0002; image: torch.Size([1, 271, 271, 438])(torch.float32)
[2025-05-18 14:49:21,237] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [128, 128, 128], 'sw_batch_size': 1, 'overlap': 0.25, 'mode': constant, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-18 14:49:21,237] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/best_FL_pancreas_model.pt
[2025-05-18 14:49:33,535] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-18 14:49:33,536] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 14:49:33,749] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.2113; image: torch.Size([8, 512, 512, 132])(torch.float32); pred: torch.Size([8, 271, 271, 438])(torch.float32)
[2025-05-18 14:49:33,752] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0026; image: torch.Size([8, 512, 512, 132])(torch.float32); pred: torch.Size([8, 271, 271, 438])(torch.float32)
[2025-05-18 14:49:33,753] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-18 14:49:33,753] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 14:49:33,754] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 271, 271, 438])(torch.float32); pred: torch.Size([8, 512, 512, 132])(torch.float32)
[2025-05-18 14:49:33,787] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0322; image: torch.Size([1, 271, 271, 438])(torch.float32); pred: torch.Size([8, 512, 512, 132])(torch.float32)
[2025-05-18 14:49:33,798] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.011; image: torch.Size([1, 271, 271, 438])(torch.float32); pred: torch.Size([1, 512, 512, 132])(torch.float32)
[2025-05-18 14:49:33,798] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0003; image: torch.Size([1, 271, 271, 438])(torch.float32); pred: torch.Size([512, 512, 132])(torch.float32)
[2025-05-18 14:49:33,799] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-18 14:49:33,800] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-18 14:49:37,329] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 20.0193; Pre: 3.9245; Inferer: 12.2530; Invert: 0.2638; Post: 0.0470; Write: 3.5301
[2025-05-18 14:49:37,329] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmp2gahjggp.nrrd
[2025-05-18 14:49:37,330] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-18 14:53:08,472] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-18 14:53:08,476] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 21; Weight: 1747579988
[2025-05-18 14:53:08,583] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '21', 'weight': 1747579988, 'path': '/data/21.nii.gz', 'ts': 1747365741, 'name': '21.nii.gz'}
[2025-05-18 14:53:34,465] [1] [MainThread] [INFO] (monailabel.endpoints.infer:169) - Infer Request: {'model': 'pinkcc_ct_segresnet', 'image': '21', 'device': 'Tesla P100-PCIE-16GB:0', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz'}
[2025-05-18 14:53:34,467] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:280) - Infer Request (final): {'device': 'cuda:0', 'model': 'pinkcc_ct_segresnet', 'image': '/data/21.nii.gz', 'result_extension': '.nrrd', 'result_dtype': 'uint8', 'client_id': 'user-xyz', 'description': 'SegResNet ovary segmentaion model PINKCC CT dataset.'}
[2025-05-18 14:53:34,470] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - PRE - Run Transform(s)
[2025-05-18 14:53:34,470] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - PRE - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path']
[2025-05-18 14:53:35,747] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (LoadImaged): Time: 1.2755; image: torch.Size([512, 512, 117])(torch.float32)
[2025-05-18 14:53:35,748] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureChannelFirstd): Time: 0.0005; image: torch.Size([1, 512, 512, 117])(torch.float32)
[2025-05-18 14:53:35,767] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Orientationd): Time: 0.0188; image: torch.Size([1, 512, 512, 117])(torch.float32)
[2025-05-18 14:53:35,888] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (ScaleIntensityRanged): Time: 0.1204; image: torch.Size([1, 512, 512, 117])(torch.float32)
[2025-05-18 14:53:37,791] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (Spacingd): Time: 1.9032; image: torch.Size([1, 275, 275, 388])(torch.float32)
[2025-05-18 14:53:37,792] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - PRE - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 275, 275, 388])(torch.float32)
[2025-05-18 14:53:37,793] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:503) - Inferer:: cuda:0 => SlidingWindowInferer => {'roi_size': [96, 96, 96], 'sw_batch_size': 1, 'overlap': 0.75, 'mode': gaussian, 'sigma_scale': 0.125, 'padding_mode': constant, 'cval': 0.0, 'sw_device': None, 'device': None, 'progress': False, 'cpu_thresh': None, 'buffer_steps': None, 'buffer_dim': -1, 'with_coord': False, 'roi_weight_map': None}
[2025-05-18 14:53:37,794] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:432) - Infer model path: /apps/radiology/model/pinkcc_ct_segresnet.ckpt
[2025-05-18 14:54:32,758] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - INV - Run Transform(s)
[2025-05-18 14:54:32,759] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - INV - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 14:54:32,787] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Spacingd): Time: 0.0264; image: torch.Size([3, 512, 512, 117])(torch.float32); pred: torch.Size([3, 275, 275, 388])(torch.float32)
[2025-05-18 14:54:32,789] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - INV - Transform (Orientationd): Time: 0.0024; image: torch.Size([3, 512, 512, 117])(torch.float32); pred: torch.Size([3, 275, 275, 388])(torch.float32)
[2025-05-18 14:54:32,791] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:76) - POST - Run Transform(s)
[2025-05-18 14:54:32,791] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:77) - POST - Input Keys: ['device', 'model', 'image', 'result_extension', 'result_dtype', 'client_id', 'description', 'image_path', 'latencies', 'pred']
[2025-05-18 14:54:32,792] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (EnsureTyped): Time: 0.0001; image: torch.Size([1, 275, 275, 388])(torch.float32); pred: torch.Size([3, 512, 512, 117])(torch.float32)
[2025-05-18 14:54:32,792] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Activationsd): Time: 0.0003; image: torch.Size([1, 275, 275, 388])(torch.float32); pred: torch.Size([3, 512, 512, 117])(torch.float32)
[2025-05-18 14:54:32,793] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (AsDiscreted): Time: 0.0004; image: torch.Size([1, 275, 275, 388])(torch.float32); pred: torch.Size([1, 512, 512, 117])(torch.float32)
[2025-05-18 14:54:32,794] [1] [MainThread] [INFO] (monailabel.interfaces.utils.transform:122) - POST - Transform (Restored): Time: 0.0002; image: torch.Size([1, 275, 275, 388])(torch.float32); pred: torch.Size([512, 512, 117])(torch.float32)
[2025-05-18 14:54:32,794] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:603) - Writing Result...
[2025-05-18 14:54:32,795] [1] [MainThread] [INFO] (monailabel.transform.writer:196) - Result ext: .nrrd; write_to_file: True; dtype: uint8
[2025-05-18 14:54:33,162] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:335) - ++ Latencies => Total: 58.6960; Pre: 3.3252; Inferer: 54.9298; Invert: 0.0673; Post: 0.0044; Write: 0.3681
[2025-05-18 14:54:33,163] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:370) - Result File: /tmp/tmp8as9o3fs.nrrd
[2025-05-18 14:54:33,163] [1] [MainThread] [INFO] (monailabel.tasks.infer.basic_infer:371) - Result Json Keys: ['label_names', 'latencies', 'centroids']
[2025-05-19 07:29:02,867] [1] [MainThread] [INFO] (monailabel.interfaces.utils.app:37) - Initializing App from: /apps/radiology; studies: /data; conf: {'models': 'manafaln,sam2,scribbles', 'mfn_config': 'config/active_learning_pinkcc_segresnet.yaml,config/active_learning_pan.yaml,config/active_learning_FL.yaml'}
[2025-05-19 07:29:03,209] [1] [MainThread] [INFO] (monailabel.utils.others.class_utils:57) - Subclass for MONAILabelApp Found: <class 'main.RadiologyApp'>
[2025-05-19 07:29:03,678] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-19 07:29:03,771] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-19 07:29:03,851] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.configs.segmentation:80) - EPISTEMIC Enabled: False;Samples: 5
[2025-05-19 07:29:03,851] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:138) - +++ Using Models: ['pan_mri_mednext', 'pinkcc_ct_segresnet', 'FL_ct_mednext']
[2025-05-19 07:29:03,851] [1] [MainThread] [INFO] (monailabel.interfaces.app:135) - Init Datastore for: /data
[2025-05-19 07:29:03,852] [1] [MainThread] [INFO] (monailabel.datastore.local:130) - Auto Reload: True; Extensions: ['*.nii.gz', '*.nii', '*.nrrd', '*.jpg', '*.png', '*.tif', '*.svs', '*.xml']
[2025-05-19 07:29:03,909] [1] [MainThread] [INFO] (monailabel.datastore.local:577) - Invalidate count: 0
[2025-05-19 07:29:03,909] [1] [MainThread] [INFO] (monailabel.datastore.local:151) - Start observing external modifications on datastore (AUTO RELOAD)
[2025-05-19 07:29:04,103] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pan_mri_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f987c2b7c70>
[2025-05-19 07:29:04,166] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f987c0e0f70>
[2025-05-19 07:29:04,601] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:172) - +++ Adding Inferer:: FL_ct_mednext => <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f987c0e0fa0>
[2025-05-19 07:29:04,609] [1] [MainThread] [INFO] (monailabel.sam2.infer:65) - Image Cache Initialized: /root/.cache/monailabel/sam2
[2025-05-19 07:29:04,610] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-19 07:29:04,610] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function ImageCache.monitor.<locals>.run_scheduler at 0x7f986462ed40>
[2025-05-19 07:29:04,610] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-19 07:29:04,616] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:223) - {'pan_mri_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f987c2b7c70>, 'pinkcc_ct_segresnet': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f987c0e0f70>, 'FL_ct_mednext': <manafaln.adapters.monailabel.infers.segmentation.ManafalnInferTask object at 0x7f987c0e0fa0>, 'sam_2d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f98647470a0>, 'sam_3d': <monailabel.sam2.infer.Sam2InferTask object at 0x7f9864747070>, 'Histogram+GraphCut': <monailabel.scribbles.infer.HistogramBasedGraphCut object at 0x7f9864772cb0>, 'GMM+GraphCut': <monailabel.scribbles.infer.GMMBasedGraphCut object at 0x7f987c1fa740>}
[2025-05-19 07:29:04,740] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pan_mri_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f987c6b3a60>
[2025-05-19 07:29:04,804] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: pinkcc_ct_segresnet => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f9864613fd0>
[2025-05-19 07:29:04,933] [1] [MainThread] [INFO] (manafaln.adapters.monailabel.apps.radiology:238) - +++ Adding Trainer:: FL_ct_mednext => <manafaln.adapters.monailabel.trainers.segmentation.ManafalnTrainTask object at 0x7f9864613f70>
[2025-05-19 07:29:04,934] [1] [MainThread] [INFO] (monailabel.utils.sessions:51) - Session Path: /root/.cache/monailabel/sessions
[2025-05-19 07:29:04,934] [1] [MainThread] [INFO] (monailabel.utils.sessions:52) - Session Expiry (max): 3600
[2025-05-19 07:29:04,935] [1] [MainThread] [INFO] (monailabel.interfaces.app:469) - App Init - completed
[2025-05-19 07:29:04,936] [1] [MainThread] [INFO] (timeloop:60) - Starting Timeloop..
[2025-05-19 07:29:04,936] [1] [MainThread] [INFO] (timeloop:42) - Registered job <function MONAILabelApp.on_init_complete.<locals>.run_scheduler at 0x7f9864651090>
[2025-05-19 07:29:04,937] [1] [MainThread] [INFO] (timeloop:63) - Timeloop now started. Jobs will run based on the interval set
[2025-05-19 07:29:17,343] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:44) - Active Learning Request: {'strategy': 'random', 'client_id': 'user-xyz'}
[2025-05-19 07:29:17,346] [1] [MainThread] [INFO] (monailabel.tasks.activelearning.random:47) - Random: Selected Image: 36; Weight: 1747639757
[2025-05-19 07:29:17,360] [1] [MainThread] [INFO] (monailabel.endpoints.activelearning:60) - Next sample: {'id': '36', 'weight': 1747639757, 'path': '/data/36.nii.gz', 'ts': 1747365741, 'name': '36.nii.gz'}
